<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Numeric.Backprop</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Numeric.Backprop.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">backprop-0.1.0.0: Heterogeneous, type-safe automatic backpropagation in Haskell</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) Justin Le 2018</td></tr><tr><th>License</th><td>BSD3</td></tr><tr><th>Maintainer</th><td>justin@jle.im</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Portability</th><td>non-portable</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Numeric.Backprop</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Types</a></li><li><a href="#g:2">Running</a></li><li><a href="#g:3">Manipulating <code>BVar</code></a><ul><li><a href="#g:4">With <code>Op</code>s</a></li></ul></li><li><a href="#g:5"><code>Op</code></a><ul><li><a href="#g:6">Creation</a><ul><li><a href="#g:7">Giving gradients directly</a></li><li><a href="#g:8">Automatic creation using the <em>ad</em> library</a></li><li><a href="#g:9">From Isomorphisms</a></li></ul></li></ul></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Automatic differentation and backpropagation.</p><p>Main idea: Write a function computing what you want, and the library
 automatically provies the gradient of that function as well, for usage
 with gradient descent and other training methods.</p><p>In more detail: instead of working directly with values to produce your
 result, you work with <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s containing those values.  Working with
 these <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s is made smooth with the usage of lenses and other
 combinators, and libraries can offer operatons on <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s instead of
 those on normal types directly.</p><p>Then, you can use:</p><pre><code><a href="Numeric-Backprop.html#v:evalBP">evalBP</a></code> :: (<code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> s a -&gt; BVar s b) -&gt; (a -&gt; b)
</pre><p>to turn a <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> function into the function on actual values <code>a -&gt; b</code>.
 This has virtually zero overhead over writing the actual function
 directly.</p><p>Then, there's:</p><pre><code><a href="Numeric-Backprop.html#v:gradBP">gradBP</a></code> :: (<code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> s a -&gt; BVar s b) -&gt; (a -&gt; a)
</pre><p>To automatically get the <em>gradient</em>, as well, for a given input.</p><p>See the <a href="https://github.com/mstksg/backprop">README</a> for more information
 and links to demonstrations and tutorials.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span> <a href="#t:BVar">BVar</a> s a</li><li class="src short"><span class="keyword">data</span> <a href="#t:W">W</a></li><li class="src short"><a href="#v:backprop">backprop</a> :: <span class="keyword">forall</span> a b. (<a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b) =&gt; (<span class="keyword">forall</span> s. <a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a> =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b) -&gt; a -&gt; (b, a)</li><li class="src short"><a href="#v:evalBP">evalBP</a> :: <span class="keyword">forall</span> a b. (<a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b) =&gt; (<span class="keyword">forall</span> s. <a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a> =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b) -&gt; a -&gt; b</li><li class="src short"><a href="#v:gradBP">gradBP</a> :: <span class="keyword">forall</span> a b. (<a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b) =&gt; (<span class="keyword">forall</span> s. <a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a> =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b) -&gt; a -&gt; a</li><li class="src short"><a href="#v:constVar">constVar</a> :: a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a</li><li class="src short"><a href="#v:viewVar">viewVar</a> :: <span class="keyword">forall</span> a b s. (<a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a>, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a) =&gt; <a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens-39-">Lens'</a> b a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a</li><li class="src short"><a href="#v:setVar">setVar</a> :: <span class="keyword">forall</span> a b s. (<a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a>, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b) =&gt; <a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens-39-">Lens'</a> b a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b</li><li class="src short"><a href="#v:-94--94-.">(^^.)</a> :: <span class="keyword">forall</span> a b s. (<a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a>, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a) =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b -&gt; <a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens-39-">Lens'</a> b a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a</li><li class="src short"><a href="#v:.-126--126-">(.~~)</a> :: <span class="keyword">forall</span> a b s. (<a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a>, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b) =&gt; <a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens-39-">Lens'</a> b a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b</li><li class="src short"><a href="#v:sequenceVar">sequenceVar</a> :: <span class="keyword">forall</span> t a s. (<a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a>, <a href="../base-4.10.1.0/Data-Traversable.html#t:Traversable">Traversable</a> t, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a) =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s (t a) -&gt; t (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s a)</li><li class="src short"><a href="#v:collectVar">collectVar</a> :: <span class="keyword">forall</span> a t s. (<a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a>, <a href="../base-4.10.1.0/Data-Foldable.html#t:Foldable">Foldable</a> t, <a href="../base-4.10.1.0/Data-Functor.html#t:Functor">Functor</a> t, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> (t a), <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a) =&gt; t (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s a) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s (t a)</li><li class="src short"><a href="#v:uncurryVar">uncurryVar</a> :: (<a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b) =&gt; (<span class="keyword">forall</span> s. <a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a> =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s c) -&gt; <span class="keyword">forall</span> s. <a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a> =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s (a, b) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s c</li><li class="src short"><a href="#v:uncurryVar3">uncurryVar3</a> :: (<a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> c) =&gt; (<span class="keyword">forall</span> s. <a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a> =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s c -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s d) -&gt; <span class="keyword">forall</span> s. <a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a> =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s (a, b, c) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s d</li><li class="src short"><a href="#v:liftOp">liftOp</a> :: <span class="keyword">forall</span> s as b. (<a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a>, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b, <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> as) =&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as b -&gt; <a href="Numeric-Backprop-Op.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s) as -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b</li><li class="src short"><a href="#v:liftOp1">liftOp1</a> :: <span class="keyword">forall</span> s a b. (<a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a>, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b) =&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a] b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b</li><li class="src short"><a href="#v:liftOp2">liftOp2</a> :: <span class="keyword">forall</span> s a b c. (<a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a>, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> c) =&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a, b] c -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s c</li><li class="src short"><a href="#v:liftOp3">liftOp3</a> :: <span class="keyword">forall</span> s a b c d. (<a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a>, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> c, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> d) =&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a, b, c] d -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s c -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s d</li><li class="src short"><a href="#v:liftOp4">liftOp4</a> :: <span class="keyword">forall</span> s a b c d e. (<a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a>, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> c, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> d, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> e) =&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a, b, c, d] e -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s c -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s d -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s e</li><li class="src short"><span class="keyword">newtype</span> <a href="#t:Op">Op</a> as a = <a href="#v:Op">Op</a> {<ul class="subs"><li><a href="#v:runOpWith">runOpWith</a> :: <a href="Numeric-Backprop-Op.html#t:Tuple">Tuple</a> as -&gt; (a, a -&gt; <a href="Numeric-Backprop-Op.html#t:Tuple">Tuple</a> as)</li></ul>}</li><li class="src short"><a href="#v:op0">op0</a> :: a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[] a</li><li class="src short"><a href="#v:opConst">opConst</a> :: (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> as, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> as) =&gt; a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a</li><li class="src short"><a href="#v:idOp">idOp</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> '[a] a</li><li class="src short"><a href="#v:opConst-39-">opConst'</a> :: <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> as =&gt; <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> as -&gt; a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a</li><li class="src short"><a href="#v:op1">op1</a> :: (a -&gt; (b, b -&gt; a)) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a] b</li><li class="src short"><a href="#v:op2">op2</a> :: (a -&gt; b -&gt; (c, c -&gt; (a, b))) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a, b] c</li><li class="src short"><a href="#v:op3">op3</a> :: (a -&gt; b -&gt; c -&gt; (d, d -&gt; (a, b, c))) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a, b, c] d</li><li class="src short"><a href="#v:op1-39-">op1'</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a =&gt; (<span class="keyword">forall</span> s. <a href="../ad-4.3.5/Numeric-AD-Internal-Type.html#t:AD">AD</a> s (<a href="../ad-4.3.5/Numeric-AD-Rank1-Forward.html#t:Forward">Forward</a> a) -&gt; <a href="../ad-4.3.5/Numeric-AD-Internal-Type.html#t:AD">AD</a> s (<a href="../ad-4.3.5/Numeric-AD-Rank1-Forward.html#t:Forward">Forward</a> a)) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a] a</li><li class="src short"><a href="#v:op2-39-">op2'</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a =&gt; (<span class="keyword">forall</span> s. <a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="../ad-4.3.5/Numeric-AD-Internal-Reverse.html#t:Tape">Tape</a> =&gt; <a href="../ad-4.3.5/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a -&gt; <a href="../ad-4.3.5/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a -&gt; <a href="../ad-4.3.5/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a, a] a</li><li class="src short"><a href="#v:op3-39-">op3'</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a =&gt; (<span class="keyword">forall</span> s. <a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="../ad-4.3.5/Numeric-AD-Internal-Reverse.html#t:Tape">Tape</a> =&gt; <a href="../ad-4.3.5/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a -&gt; <a href="../ad-4.3.5/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a -&gt; <a href="../ad-4.3.5/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a -&gt; <a href="../ad-4.3.5/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a, a, a] a</li><li class="src short"><a href="#v:opN-39-">opN'</a> :: (<a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Nat.html#t:Nat">Nat</a> n) =&gt; (<span class="keyword">forall</span> s. <a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="../ad-4.3.5/Numeric-AD-Internal-Reverse.html#t:Tape">Tape</a> =&gt; <a href="../type-combinators-0.2.4.3/Data-Type-Vector.html#t:Vec">Vec</a> n (<a href="../ad-4.3.5/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a) -&gt; <a href="../ad-4.3.5/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> (<a href="Numeric-Backprop.html#t:Replicate">Replicate</a> n a) a</li><li class="src short"><span class="keyword">type family</span> <a href="#t:Replicate">Replicate</a> (n :: <a href="../type-combinators-0.2.4.3/Type-Family-Nat.html#t:N">N</a>) (a :: k) = (as :: [k]) | as -&gt; n <span class="keyword">where ...</span></li><li class="src short"><a href="#v:opCoerce">opCoerce</a> :: <a href="../base-4.10.1.0/Data-Coerce.html#t:Coercible">Coercible</a> a b =&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a] b</li><li class="src short"><a href="#v:opTup">opTup</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as (<a href="Numeric-Backprop-Op.html#t:Tuple">Tuple</a> as)</li><li class="src short"><a href="#v:opIso">opIso</a> :: (a -&gt; b) -&gt; (b -&gt; a) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a] b</li><li class="src short"><a href="#v:opLens">opLens</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a =&gt; <a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens-39-">Lens'</a> a b -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a] b</li></ul></div><div id="interface"><h1 id="g:1">Types</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:BVar" class="def">BVar</a> s a <a href="src/Numeric.Backprop.Internal.html#BVar" class="link">Source</a> <a href="#t:BVar" class="selflink">#</a></p><div class="doc"><p>A <code><code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> s a</code> is a value of type <code>a</code> that can be &quot;backpropagated&quot;.</p><p>Functions referring to <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s are tracked by the library and can be
 automatically differentiated to get their gradients and results.</p><p>For simple numeric values, you can use its <code><a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a></code>, <code><a href="../base-4.10.1.0/Prelude.html#t:Fractional">Fractional</a></code>, and
 <code><a href="../base-4.10.1.0/Numeric.html#t:Floating">Floating</a></code> instances to manipulate them as if they were the numbers they
 represent.</p><p>If <code>a</code> contains items, the items can be accessed and extracted using
 lenses. A <code><code><a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens-39-">Lens'</a></code> b a</code> can be used to access an <code>a</code> inside a <code>b</code>:</p><pre>(<code><a href="../microlens-0.4.8.3/Lens-Micro.html#v:-94-.">^.</a></code>)  ::        a -&gt; <code><a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens-39-">Lens'</a></code> a b -&gt;        b
(<code>^^.</code>) :: <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> s a -&gt; <code><a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens-39-">Lens'</a></code> a b -&gt; <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> s b
</pre><p>For more complex operations, libraries can provide functions on <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s
 using <code><a href="Numeric-Backprop.html#v:liftOp">liftOp</a></code> and related functions.  This is how you can create
 primitive functions that users can use to manipulate your library's
 values.</p><p>For example, the <em>hmatrix</em> library has a matrix-vector multiplication
 function, <code>#&gt; :: L m n -&gt; R n -&gt; L m</code>.</p><p>A library could instead provide a function <code>#&gt; :: <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> (L m n) -&gt; BVar
 (R n) -&gt; BVar (R m)</code>, which the user can then use to manipulate their
 <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s of <code>L m n</code>s and <code>R n</code>s, etc.</p><p>See <a href="Numeric-Backprop.html#liftops">Numeric.Backprop</a> and documentation for <code><a href="Numeric-Backprop.html#v:liftOp">liftOp</a></code> for more
 information.</p></div><div class="subs instances"><p id="control.i:BVar" class="caption collapser" onclick="toggleSection('i:BVar')">Instances</p><div id="section.i:BVar" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:BVar:Floating:1" class="instance expander" onclick="toggleSection('i:id:BVar:Floating:1')"></span> (<a href="../base-4.10.1.0/Numeric.html#t:Floating">Floating</a> a, <a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> <a href="../base-4.10.1.0/Data-Kind.html#t:Type">Type</a> s <a href="Numeric-Backprop.html#t:W">W</a>) =&gt; <a href="../base-4.10.1.0/Numeric.html#t:Floating">Floating</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s a)</span> <a href="src/Numeric.Backprop.Internal.html#line-557" class="link">Source</a> <a href="#t:BVar" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:BVar:Floating:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:pi">pi</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:pi" class="selflink">#</a></p><p class="src"><a href="#v:exp">exp</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:exp" class="selflink">#</a></p><p class="src"><a href="#v:log">log</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:log" class="selflink">#</a></p><p class="src"><a href="#v:sqrt">sqrt</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:sqrt" class="selflink">#</a></p><p class="src"><a href="#v:-42--42-">(**)</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:-42--42-" class="selflink">#</a></p><p class="src"><a href="#v:logBase">logBase</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:logBase" class="selflink">#</a></p><p class="src"><a href="#v:sin">sin</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:sin" class="selflink">#</a></p><p class="src"><a href="#v:cos">cos</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:cos" class="selflink">#</a></p><p class="src"><a href="#v:tan">tan</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:tan" class="selflink">#</a></p><p class="src"><a href="#v:asin">asin</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:asin" class="selflink">#</a></p><p class="src"><a href="#v:acos">acos</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:acos" class="selflink">#</a></p><p class="src"><a href="#v:atan">atan</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:atan" class="selflink">#</a></p><p class="src"><a href="#v:sinh">sinh</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:sinh" class="selflink">#</a></p><p class="src"><a href="#v:cosh">cosh</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:cosh" class="selflink">#</a></p><p class="src"><a href="#v:tanh">tanh</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:tanh" class="selflink">#</a></p><p class="src"><a href="#v:asinh">asinh</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:asinh" class="selflink">#</a></p><p class="src"><a href="#v:acosh">acosh</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:acosh" class="selflink">#</a></p><p class="src"><a href="#v:atanh">atanh</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:atanh" class="selflink">#</a></p><p class="src"><a href="#v:log1p">log1p</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:log1p" class="selflink">#</a></p><p class="src"><a href="#v:expm1">expm1</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:expm1" class="selflink">#</a></p><p class="src"><a href="#v:log1pexp">log1pexp</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:log1pexp" class="selflink">#</a></p><p class="src"><a href="#v:log1mexp">log1mexp</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:log1mexp" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:BVar:Fractional:2" class="instance expander" onclick="toggleSection('i:id:BVar:Fractional:2')"></span> (<a href="../base-4.10.1.0/Prelude.html#t:Fractional">Fractional</a> a, <a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> <a href="../base-4.10.1.0/Data-Kind.html#t:Type">Type</a> s <a href="Numeric-Backprop.html#t:W">W</a>) =&gt; <a href="../base-4.10.1.0/Prelude.html#t:Fractional">Fractional</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s a)</span> <a href="src/Numeric.Backprop.Internal.html#line-549" class="link">Source</a> <a href="#t:BVar" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:BVar:Fractional:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-47-">(/)</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:-47-" class="selflink">#</a></p><p class="src"><a href="#v:recip">recip</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:recip" class="selflink">#</a></p><p class="src"><a href="#v:fromRational">fromRational</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Rational">Rational</a> -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:fromRational" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:BVar:Num:3" class="instance expander" onclick="toggleSection('i:id:BVar:Num:3')"></span> (<a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> <a href="../base-4.10.1.0/Data-Kind.html#t:Type">Type</a> s <a href="Numeric-Backprop.html#t:W">W</a>) =&gt; <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s a)</span> <a href="src/Numeric.Backprop.Internal.html#line-533" class="link">Source</a> <a href="#t:BVar" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:BVar:Num:3" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-43-">(+)</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:-43-" class="selflink">#</a></p><p class="src"><a href="#v:-45-">(-)</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:-45-" class="selflink">#</a></p><p class="src"><a href="#v:-42-">(*)</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:-42-" class="selflink">#</a></p><p class="src"><a href="#v:negate">negate</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:negate" class="selflink">#</a></p><p class="src"><a href="#v:abs">abs</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:abs" class="selflink">#</a></p><p class="src"><a href="#v:signum">signum</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:signum" class="selflink">#</a></p><p class="src"><a href="#v:fromInteger">fromInteger</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="#v:fromInteger" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:BVar:NFData:4" class="instance expander" onclick="toggleSection('i:id:BVar:NFData:4')"></span> <a href="../deepseq-1.4.3.0/Control-DeepSeq.html#t:NFData">NFData</a> a =&gt; <a href="../deepseq-1.4.3.0/Control-DeepSeq.html#t:NFData">NFData</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s a)</span> <a href="src/Numeric.Backprop.Internal.html#line-104" class="link">Source</a> <a href="#t:BVar" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:BVar:NFData:4" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:rnf">rnf</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; () <a href="#v:rnf" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:W" class="def">W</a> <a href="src/Numeric.Backprop.Internal.html#W" class="link">Source</a> <a href="#t:W" class="selflink">#</a></p><div class="doc"><p>An ephemeral Wengert Tape in the environment.  Used internally to
 track of the computational graph of variables.</p><p>For the end user, one can just imagine <code><code><a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a></code> s <code><a href="Numeric-Backprop.html#t:W">W</a></code></code> as a required
 constraint on <code>s</code> that allows backpropagation to work.</p></div></div><h1 id="g:2">Running</h1><div class="top"><p class="src"><a id="v:backprop" class="def">backprop</a> :: <span class="keyword">forall</span> a b. (<a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b) =&gt; (<span class="keyword">forall</span> s. <a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a> =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b) -&gt; a -&gt; (b, a) <a href="src/Numeric.Backprop.Internal.html#backprop" class="link">Source</a> <a href="#v:backprop" class="selflink">#</a></p><div class="doc"><p>Turn a function <code><code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> s a -&gt; <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> s b</code> into the function <code>a -&gt; b</code>
 that it represents, also computing its gradient <code>a</code> as well.</p><p>Note that every type involved has to be an instance of <code><a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a></code>.  This is
 because gradients all need to be &quot;summable&quot; (which is implemented using
 <code><a href="../base-4.10.1.0/Data-Foldable.html#v:sum">sum</a></code> and <code><a href="../base-4.10.1.0/Prelude.html#v:-43-">+</a></code>), and we also need to able to generate gradients of '1'
 and '0'.  Really, only <code><a href="../base-4.10.1.0/Prelude.html#v:-43-">+</a></code> and <code><a href="../base-4.10.1.0/Prelude.html#v:fromInteger">fromInteger</a></code> methods are used from the
 <code><a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a></code> typeclass.</p></div></div><div class="top"><p class="src"><a id="v:evalBP" class="def">evalBP</a> :: <span class="keyword">forall</span> a b. (<a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b) =&gt; (<span class="keyword">forall</span> s. <a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a> =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b) -&gt; a -&gt; b <a href="src/Numeric.Backprop.html#evalBP" class="link">Source</a> <a href="#v:evalBP" class="selflink">#</a></p><div class="doc"><p>Turn a function <code><code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> s a -&gt; <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> s b</code> into the function <code>a -&gt; b</code>
 that it represents.</p><p>Benchmarks show that this should have virtually no overhead over
 directly writing a <code>a -&gt; b</code>. <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> is, in this situation, a zero-cost
 abstraction, performance-wise.</p><p>Note that every type involved has to be an instance of <code><a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a></code>.  This is
 because gradients all need to be &quot;summable&quot; (which is implemented using
 <code><a href="../base-4.10.1.0/Data-Foldable.html#v:sum">sum</a></code> and <code><a href="../base-4.10.1.0/Prelude.html#v:-43-">+</a></code>), and we also need to able to generate gradients of '1'
 and '0'.  Really, only <code><a href="../base-4.10.1.0/Prelude.html#v:-43-">+</a></code> and <code><a href="../base-4.10.1.0/Prelude.html#v:fromInteger">fromInteger</a></code> methods are used from the
 <code><a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a></code> typeclass.</p></div></div><div class="top"><p class="src"><a id="v:gradBP" class="def">gradBP</a> :: <span class="keyword">forall</span> a b. (<a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b) =&gt; (<span class="keyword">forall</span> s. <a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a> =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b) -&gt; a -&gt; a <a href="src/Numeric.Backprop.html#gradBP" class="link">Source</a> <a href="#v:gradBP" class="selflink">#</a></p><div class="doc"><p>Take a function <code><code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> s a -&gt; <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> s b</code>, interpreted as a function
 <code>a -&gt; b</code>, and compute its gradient with respect to its input.</p><p>The resulting <code>a -&gt; a</code> tells how the input (and its components) affects
 the output.  Positive numbers indicate that the result will vary in the
 same direction as any adjustment in the input.  Negative numbers
 indicate that the result will vary in the opposite direction as any
 adjustment in the input.  Larger numbers indicate a greater sensitivity
 of change, and small numbers indicate lower sensitivity.</p><p>Note that every type involved has to be an instance of <code><a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a></code>.  This is
 because gradients all need to be &quot;summable&quot; (which is implemented using
 <code><a href="../base-4.10.1.0/Data-Foldable.html#v:sum">sum</a></code> and <code><a href="../base-4.10.1.0/Prelude.html#v:-43-">+</a></code>), and we also need to able to generate gradients of '1'
 and '0'.  Really, only <code><a href="../base-4.10.1.0/Prelude.html#v:-43-">+</a></code> and <code><a href="../base-4.10.1.0/Prelude.html#v:fromInteger">fromInteger</a></code> methods are used from the
 <code><a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a></code> typeclass.</p></div></div><h1 id="g:3">Manipulating <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code></h1><div class="top"><p class="src"><a id="v:constVar" class="def">constVar</a> :: a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="src/Numeric.Backprop.Internal.html#constVar" class="link">Source</a> <a href="#v:constVar" class="selflink">#</a></p><div class="doc"><p>Lift a value into a <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> representing a constant value.</p><p>This value will not be considered an input, and its gradients will not
 be backpropagated.</p></div></div><div class="top"><p class="src"><a id="v:viewVar" class="def">viewVar</a> :: <span class="keyword">forall</span> a b s. (<a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a>, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a) =&gt; <a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens-39-">Lens'</a> b a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <a href="src/Numeric.Backprop.Internal.html#viewVar" class="link">Source</a> <a href="#v:viewVar" class="selflink">#</a></p><div class="doc"><p>Using a <code><a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens-39-">Lens'</a></code>, extract a value <em>inside</em> a <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>.</p><p>See documentation for <code>^^.</code> for more information.</p></div></div><div class="top"><p class="src"><a id="v:setVar" class="def">setVar</a> :: <span class="keyword">forall</span> a b s. (<a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a>, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b) =&gt; <a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens-39-">Lens'</a> b a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b <a href="src/Numeric.Backprop.Internal.html#setVar" class="link">Source</a> <a href="#v:setVar" class="selflink">#</a></p><div class="doc"><p>Using a <code><a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens-39-">Lens'</a></code>, set a value <em>inside</em> a <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>.</p><p>See documentation for <code>.~~</code> for more information.</p></div></div><div class="top"><p class="src"><a id="v:-94--94-." class="def">(^^.)</a> :: <span class="keyword">forall</span> a b s. (<a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a>, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a) =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b -&gt; <a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens-39-">Lens'</a> b a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a <span class="fixity">infixl 8</span><span class="rightedge"></span> <a href="src/Numeric.Backprop.html#%5E%5E." class="link">Source</a> <a href="#v:-94--94-." class="selflink">#</a></p><div class="doc"><p>An infix version of <code><a href="Numeric-Backprop.html#v:viewVar">viewVar</a></code>, meant to evoke parallels to <code><a href="../microlens-0.4.8.3/Lens-Micro.html#v:-94-.">^.</a></code> from
 lens.</p><p>With normal values, you can extract something from that value with
 a lens:</p><pre>x <code><a href="../microlens-0.4.8.3/Lens-Micro.html#v:-94-.">^.</a></code> myLens
</pre><p>Would extract a piece of <code>x :: b</code>, specified by <code>myLens :: <code><a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens-39-">Lens'</a></code> b a</code>.
 The result has type <code>a</code>.</p><pre>xVar <code><a href="Numeric-Backprop.html#v:-94--94-.">^^.</a></code> myLens
</pre><p>Would extract a piece out of <code>xVar :: <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> s b</code> (a <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> holding a
 <code>b</code>), specified by <code>myLens :: Lens' b a</code>.   The result has type <code><code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>
 s a</code> (a <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> holding a <code>a</code>)</p><p>This is the main way to pull out values from <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> of container types.</p></div></div><div class="top"><p class="src"><a id="v:.-126--126-" class="def">(.~~)</a> :: <span class="keyword">forall</span> a b s. (<a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a>, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b) =&gt; <a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens-39-">Lens'</a> b a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b <span class="fixity">infixl 8</span><span class="rightedge"></span> <a href="src/Numeric.Backprop.html#.~~" class="link">Source</a> <a href="#v:.-126--126-" class="selflink">#</a></p><div class="doc"><p>An infix version of <code><a href="Numeric-Backprop.html#v:setVar">setVar</a></code>, meant to evoke parallels to <code><a href="../microlens-0.4.8.3/Lens-Micro.html#v:.-126-">.~</a></code> from
 lens.</p><p>With normal values, you can set something in a value with a lens:
 a lens:</p><pre>x <code><a href="../base-4.10.1.0/Data-Function.html#v:-38-">&amp;</a></code> myLens <code><a href="../microlens-0.4.8.3/Lens-Micro.html#v:.-126-">.~</a></code> <code>y</code>
</pre><p>Would &quot;set&quot; a part of <code>x :: b</code>, specified by <code>myLens :: <code><a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens-39-">Lens'</a></code> a b</code>, to
 a new value <code>y :: a</code>.</p><pre>xVar <code><a href="../base-4.10.1.0/Data-Function.html#v:-38-">&amp;</a></code> myLens <code><a href="Numeric-Backprop.html#v:.-126--126-">.~~</a></code> yVar
</pre><p>Would &quot;set&quot; a part of <code>xVar :: <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> s b</code> (a <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> holding a <code>b</code>),
 specified by <code>myLens :: <code><a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens-39-">Lens'</a></code> a b</code>, to a new value given by <code>yVar ::
 <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> s a</code>.  The result is a new (updated) value of type <code><code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> s b</code>.</p><p>This is the main way to set values inside <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s of container types.</p></div></div><div class="top"><p class="src"><a id="v:sequenceVar" class="def">sequenceVar</a> :: <span class="keyword">forall</span> t a s. (<a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a>, <a href="../base-4.10.1.0/Data-Traversable.html#t:Traversable">Traversable</a> t, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a) =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s (t a) -&gt; t (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s a) <a href="src/Numeric.Backprop.Internal.html#sequenceVar" class="link">Source</a> <a href="#v:sequenceVar" class="selflink">#</a></p><div class="doc"><p>Extract all of the <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s out of a <code><a href="../base-4.10.1.0/Data-Traversable.html#t:Traversable">Traversable</a></code> container of
 <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s.</p></div></div><div class="top"><p class="src"><a id="v:collectVar" class="def">collectVar</a> :: <span class="keyword">forall</span> a t s. (<a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a>, <a href="../base-4.10.1.0/Data-Foldable.html#t:Foldable">Foldable</a> t, <a href="../base-4.10.1.0/Data-Functor.html#t:Functor">Functor</a> t, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> (t a), <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a) =&gt; t (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s a) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s (t a) <a href="src/Numeric.Backprop.Internal.html#collectVar" class="link">Source</a> <a href="#v:collectVar" class="selflink">#</a></p><div class="doc"><p>Collect all of the <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s in a container into a <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> of that
 container's contents.</p></div></div><div class="top"><p class="src"><a id="v:uncurryVar" class="def">uncurryVar</a> :: (<a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b) =&gt; (<span class="keyword">forall</span> s. <a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a> =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s c) -&gt; <span class="keyword">forall</span> s. <a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a> =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s (a, b) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s c <a href="src/Numeric.Backprop.html#uncurryVar" class="link">Source</a> <a href="#v:uncurryVar" class="selflink">#</a></p><div class="doc"><p>Convenient function to uncurry a <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> function, so it can be used
 with <code><a href="Numeric-Backprop.html#v:backprop">backprop</a></code>, <code><a href="Numeric-Backprop.html#v:evalBP">evalBP</a></code>, and <code><a href="Numeric-Backprop.html#v:gradBP">gradBP</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:uncurryVar3" class="def">uncurryVar3</a> :: (<a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> c) =&gt; (<span class="keyword">forall</span> s. <a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a> =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s c -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s d) -&gt; <span class="keyword">forall</span> s. <a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a> =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s (a, b, c) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s d <a href="src/Numeric.Backprop.html#uncurryVar3" class="link">Source</a> <a href="#v:uncurryVar3" class="selflink">#</a></p><div class="doc"><p>Convenient function to uncurry a <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> function, so it can be used
 with <code><a href="Numeric-Backprop.html#v:backprop">backprop</a></code>, <code><a href="Numeric-Backprop.html#v:evalBP">evalBP</a></code>, and <code><a href="Numeric-Backprop.html#v:gradBP">gradBP</a></code>.</p></div></div><h2 id="g:4">With <code><a href="Numeric-Backprop.html#t:Op">Op</a></code>s<a id="liftops"></a></h2><div class="doc"><p>This library provides a few primitive actions for manipulating <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s
 and the values inside them, including its <code><a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a></code>, <code><a href="../base-4.10.1.0/Prelude.html#t:Fractional">Fractional</a></code>, and
 <code><a href="../base-4.10.1.0/Numeric.html#t:Floating">Floating</a></code> instances, and lens-based operations like <code><a href="Numeric-Backprop.html#v:-94--94-.">^^.</a></code> and <code><a href="Numeric-Backprop.html#v:.-126--126-">.~~</a></code>.</p><p>However, the power of this library comes from manipulating many
 different types from libraries, like matrices and vectors.  Libraries
 can provide their own <code><code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> s a -&gt; <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> s b</code> functions, alongside
 (or in lieu of) <code>a -&gt; b</code> functions for their types.</p><p>The easiest way to create a <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> function is to use <code><a href="Numeric-Backprop.html#v:liftOp">liftOp</a></code> with an
 <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> constructor.  For example, imagine a vector library providing a dot
 product function.  We can write this using <code><a href="Numeric-Backprop.html#v:liftOp2">liftOp2</a></code> and <code><a href="Numeric-Backprop.html#v:op2">op2</a></code>:</p><pre>dot :: <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> s Vec -&gt; BVar s Vec -&gt; BVar s Double
dot = <code><a href="Numeric-Backprop.html#v:liftOp2">liftOp2</a></code> . op2 $ \xs ys -&gt;
        ( sum (zipWith (*) xs ys)
        , g -&gt; (map (*g) ys, map (*g) xs)
        )
</pre><p>We provide a function that, given the two inputs, returns:</p><ol><li>The result of the function on those two inputs</li><li>A function taking the &quot;total derivative&quot;, and returning the
     gradient with respect to each of the inputs.</li></ol><p>See documentation in <a href="Numeric-Backprop-Op.html">Numeric.Backprop.Op</a> for more information on the
 second part (the gradient).</p><p>Nice <code><a href="Numeric-Backprop.html#t:Op">Op</a></code>s are how <em>backprop</em> links together <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s and tracks them to
 determine their gradient.  Ideally, users would never have to deal with
 these when backpropagating their own functions, and library authors
 providing their matrix and vector operations, etc. would provide <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>
 variants of their normal operations.</p><p>In fact, <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> operations could even be defined <em>instead</em> of normal
 operations, since it is easy to go from <code><code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> s a -&gt; <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> s b</code> to <code>a
 -&gt; b</code>, using <code><a href="Numeric-Backprop.html#v:evalBP">evalBP</a></code>, and this carries virtually zero overhead, so some
 libraries might even provide <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> versions by default.</p></div><div class="top"><p class="src"><a id="v:liftOp" class="def">liftOp</a> :: <span class="keyword">forall</span> s as b. (<a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a>, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b, <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> as) =&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as b -&gt; <a href="Numeric-Backprop-Op.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s) as -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b <a href="src/Numeric.Backprop.Internal.html#liftOp" class="link">Source</a> <a href="#v:liftOp" class="selflink">#</a></p><div class="doc"><p>Lift an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> with an arbitrary number of inputs to a function on the
 appropriate number of <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s.</p><p>Should preferably be used only by libraries to provide primitive <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>
 functions for their types for users.</p><p>See <a href="Numeric-Backprop.html#liftops">Numeric.Backprop</a> and documentation for <code><a href="Numeric-Backprop.html#v:liftOp">liftOp</a></code> for more
 information, and <a href="Numeric-Backprop-Op.html#prod">Numeric.Backprop.Op</a> for a mini-tutorial on using
 <code><a href="Numeric-Backprop-Op.html#t:Prod">Prod</a></code> and <code><a href="Numeric-Backprop-Op.html#t:Tuple">Tuple</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:liftOp1" class="def">liftOp1</a> :: <span class="keyword">forall</span> s a b. (<a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a>, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b) =&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a] b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b <a href="src/Numeric.Backprop.Internal.html#liftOp1" class="link">Source</a> <a href="#v:liftOp1" class="selflink">#</a></p><div class="doc"><p>Lift an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> with a single input to be a function on a single <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>.</p><p>Should preferably be used only by libraries to provide primitive <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>
 functions for their types for users.</p><p>See <a href="Numeric-Backprop.html#liftops">Numeric.Backprop</a> and documentation for <code><a href="Numeric-Backprop.html#v:liftOp">liftOp</a></code> for more
 information.</p></div></div><div class="top"><p class="src"><a id="v:liftOp2" class="def">liftOp2</a> :: <span class="keyword">forall</span> s a b c. (<a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a>, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> c) =&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a, b] c -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s c <a href="src/Numeric.Backprop.Internal.html#liftOp2" class="link">Source</a> <a href="#v:liftOp2" class="selflink">#</a></p><div class="doc"><p>Lift an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> with two inputs to be a function on a two <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s.</p><p>Should preferably be used only by libraries to provide primitive <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>
 functions for their types for users.</p><p>See <a href="Numeric-Backprop.html#liftops">Numeric.Backprop</a> and documentation for <code><a href="Numeric-Backprop.html#v:liftOp">liftOp</a></code> for more
 information.</p></div></div><div class="top"><p class="src"><a id="v:liftOp3" class="def">liftOp3</a> :: <span class="keyword">forall</span> s a b c d. (<a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a>, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> c, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> d) =&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a, b, c] d -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s c -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s d <a href="src/Numeric.Backprop.Internal.html#liftOp3" class="link">Source</a> <a href="#v:liftOp3" class="selflink">#</a></p><div class="doc"><p>Lift an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> with three inputs to be a function on a three <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s.</p><p>Should preferably be used only by libraries to provide primitive <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>
 functions for their types for users.</p><p>See <a href="Numeric-Backprop.html#liftops">Numeric.Backprop</a> and documentation for <code><a href="Numeric-Backprop.html#v:liftOp">liftOp</a></code> for more
 information.</p></div></div><div class="top"><p class="src"><a id="v:liftOp4" class="def">liftOp4</a> :: <span class="keyword">forall</span> s a b c d e. (<a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="Numeric-Backprop.html#t:W">W</a>, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> c, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> d, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> e) =&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a, b, c, d] e -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s c -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s d -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s e <a href="src/Numeric.Backprop.Internal.html#liftOp4" class="link">Source</a> <a href="#v:liftOp4" class="selflink">#</a></p><div class="doc"><p>Lift an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> with four inputs to be a function on a four <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s.</p><p>Should preferably be used only by libraries to provide primitive <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>
 functions for their types for users.</p><p>See <a href="Numeric-Backprop.html#liftops">Numeric.Backprop</a> and documentation for <code><a href="Numeric-Backprop.html#v:liftOp">liftOp</a></code> for more
 information.</p></div></div><h1 id="g:5"><code><a href="Numeric-Backprop.html#t:Op">Op</a></code></h1><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:Op" class="def">Op</a> as a <a href="src/Numeric.Backprop.Op.html#Op" class="link">Source</a> <a href="#t:Op" class="selflink">#</a></p><div class="doc"><p>An <code><code><a href="Numeric-Backprop.html#t:Op">Op</a></code> as a</code> describes a differentiable function from <code>as</code> to <code>a</code>.</p><p>For example, a value of type</p><pre><code><a href="Numeric-Backprop.html#t:Op">Op</a></code> '[Int, Bool] Double
</pre><p>is a function from an <code><a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a></code> and a <code><a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></code>, returning a <code><a href="../base-4.10.1.0/Prelude.html#t:Double">Double</a></code>.  It can
 be differentiated to give a <em>gradient</em> of an <code><a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a></code> and a <code><a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></code> if given
 a total derivative for the <code>Double</code>.  If we call <code><a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></code> \(2\), then,
 mathematically, it is akin to a:</p><p>\[
 f : \mathbb{Z} \times 2 \rightarrow \mathbb{R}
 \]</p><p>See <code><a href="Numeric-Backprop-Op.html#v:runOp">runOp</a></code>, <code><a href="Numeric-Backprop-Op.html#v:gradOp">gradOp</a></code>, and <code><a href="Numeric-Backprop-Op.html#v:gradOpWith">gradOpWith</a></code> for examples on how to run it,
 and <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> for instructions on creating it.</p><p>It is simpler to not use this type constructor directly, and instead use
 the <code><a href="Numeric-Backprop.html#v:op2">op2</a></code>, <code><a href="Numeric-Backprop.html#v:op1">op1</a></code>, <code><a href="Numeric-Backprop.html#v:op2">op2</a></code>, and <code><a href="Numeric-Backprop.html#v:op3">op3</a></code> helper smart constructors  And,
 if your function is a numeric function, they can even be created
 automatically using <code><a href="Numeric-Backprop.html#v:op1-39-">op1'</a></code>, <code><a href="Numeric-Backprop.html#v:op2-39-">op2'</a></code>, <code><a href="Numeric-Backprop.html#v:op3-39-">op3'</a></code>, and <code>opN</code> with a little help
 from <a href="../ad-4.3.5/Numeric-AD.html">Numeric.AD</a> from the <em>ad</em> library.</p><p>See <a href="Numeric-Backprop-Op.html#prod">Numeric.Backprop.Op</a> for a mini-tutorial on using <code><a href="Numeric-Backprop-Op.html#t:Prod">Prod</a></code> and
 <code><a href="Numeric-Backprop-Op.html#t:Tuple">Tuple</a></code>.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Op" class="def">Op</a></td><td class="doc"><p>Construct an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> by giving a function creating the
 result, and also a continuation on how to create the gradient, given
 the total derivative of <code>a</code>.</p><p>See the module documentation for <a href="Numeric-Backprop-Op.html">Numeric.Backprop.Op</a> for more
 details on the function that this constructor and <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> expect.</p></td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:runOpWith" class="def">runOpWith</a> :: <a href="Numeric-Backprop-Op.html#t:Tuple">Tuple</a> as -&gt; (a, a -&gt; <a href="Numeric-Backprop-Op.html#t:Tuple">Tuple</a> as)</dfn><div class="doc"><p>Run the function that the <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> encodes, returning
 a continuation to compute the gradient, given the total
 derivative of <code>a</code>.  See documentation for <a href="Numeric-Backprop-Op.html">Numeric.Backprop.Op</a>
 for more information.</p></div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:Op" class="caption collapser" onclick="toggleSection('i:Op')">Instances</p><div id="section.i:Op" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Op:Floating:1" class="instance expander" onclick="toggleSection('i:id:Op:Floating:1')"></span> (<a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> [<a href="../base-4.10.1.0/Data-Kind.html#t:-42-">*</a>] (<a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> <a href="../base-4.10.1.0/Data-Kind.html#t:-42-">*</a>) as, <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.10.1.0/Data-Kind.html#t:-42-">*</a> <a href="../base-4.10.1.0/Numeric.html#t:Floating">Floating</a> as, <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.10.1.0/Data-Kind.html#t:-42-">*</a> <a href="../base-4.10.1.0/Prelude.html#t:Fractional">Fractional</a> as, <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.10.1.0/Data-Kind.html#t:-42-">*</a> <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> as, <a href="../base-4.10.1.0/Numeric.html#t:Floating">Floating</a> a) =&gt; <a href="../base-4.10.1.0/Numeric.html#t:Floating">Floating</a> (<a href="Numeric-Backprop.html#t:Op">Op</a> as a)</span> <a href="src/Numeric.Backprop.Op.html#line-605" class="link">Source</a> <a href="#t:Op" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Op:Floating:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:pi">pi</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:pi" class="selflink">#</a></p><p class="src"><a href="#v:exp">exp</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:exp" class="selflink">#</a></p><p class="src"><a href="#v:log">log</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:log" class="selflink">#</a></p><p class="src"><a href="#v:sqrt">sqrt</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:sqrt" class="selflink">#</a></p><p class="src"><a href="#v:-42--42-">(**)</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:-42--42-" class="selflink">#</a></p><p class="src"><a href="#v:logBase">logBase</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:logBase" class="selflink">#</a></p><p class="src"><a href="#v:sin">sin</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:sin" class="selflink">#</a></p><p class="src"><a href="#v:cos">cos</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:cos" class="selflink">#</a></p><p class="src"><a href="#v:tan">tan</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:tan" class="selflink">#</a></p><p class="src"><a href="#v:asin">asin</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:asin" class="selflink">#</a></p><p class="src"><a href="#v:acos">acos</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:acos" class="selflink">#</a></p><p class="src"><a href="#v:atan">atan</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:atan" class="selflink">#</a></p><p class="src"><a href="#v:sinh">sinh</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:sinh" class="selflink">#</a></p><p class="src"><a href="#v:cosh">cosh</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:cosh" class="selflink">#</a></p><p class="src"><a href="#v:tanh">tanh</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:tanh" class="selflink">#</a></p><p class="src"><a href="#v:asinh">asinh</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:asinh" class="selflink">#</a></p><p class="src"><a href="#v:acosh">acosh</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:acosh" class="selflink">#</a></p><p class="src"><a href="#v:atanh">atanh</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:atanh" class="selflink">#</a></p><p class="src"><a href="#v:log1p">log1p</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:log1p" class="selflink">#</a></p><p class="src"><a href="#v:expm1">expm1</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:expm1" class="selflink">#</a></p><p class="src"><a href="#v:log1pexp">log1pexp</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:log1pexp" class="selflink">#</a></p><p class="src"><a href="#v:log1mexp">log1mexp</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:log1mexp" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Op:Fractional:2" class="instance expander" onclick="toggleSection('i:id:Op:Fractional:2')"></span> (<a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> [<a href="../base-4.10.1.0/Data-Kind.html#t:-42-">*</a>] (<a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> <a href="../base-4.10.1.0/Data-Kind.html#t:-42-">*</a>) as, <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.10.1.0/Data-Kind.html#t:-42-">*</a> <a href="../base-4.10.1.0/Prelude.html#t:Fractional">Fractional</a> as, <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.10.1.0/Data-Kind.html#t:-42-">*</a> <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> as, <a href="../base-4.10.1.0/Prelude.html#t:Fractional">Fractional</a> a) =&gt; <a href="../base-4.10.1.0/Prelude.html#t:Fractional">Fractional</a> (<a href="Numeric-Backprop.html#t:Op">Op</a> as a)</span> <a href="src/Numeric.Backprop.Op.html#line-598" class="link">Source</a> <a href="#t:Op" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Op:Fractional:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-47-">(/)</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:-47-" class="selflink">#</a></p><p class="src"><a href="#v:recip">recip</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:recip" class="selflink">#</a></p><p class="src"><a href="#v:fromRational">fromRational</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Rational">Rational</a> -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:fromRational" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Op:Num:3" class="instance expander" onclick="toggleSection('i:id:Op:Num:3')"></span> (<a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> [<a href="../base-4.10.1.0/Data-Kind.html#t:-42-">*</a>] (<a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> <a href="../base-4.10.1.0/Data-Kind.html#t:-42-">*</a>) as, <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.10.1.0/Data-Kind.html#t:-42-">*</a> <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> as, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a) =&gt; <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> (<a href="Numeric-Backprop.html#t:Op">Op</a> as a)</span> <a href="src/Numeric.Backprop.Op.html#line-582" class="link">Source</a> <a href="#t:Op" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Op:Num:3" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-43-">(+)</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:-43-" class="selflink">#</a></p><p class="src"><a href="#v:-45-">(-)</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:-45-" class="selflink">#</a></p><p class="src"><a href="#v:-42-">(*)</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:-42-" class="selflink">#</a></p><p class="src"><a href="#v:negate">negate</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:negate" class="selflink">#</a></p><p class="src"><a href="#v:abs">abs</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:abs" class="selflink">#</a></p><p class="src"><a href="#v:signum">signum</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:signum" class="selflink">#</a></p><p class="src"><a href="#v:fromInteger">fromInteger</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="#v:fromInteger" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><h2 id="g:6">Creation</h2><div class="top"><p class="src"><a id="v:op0" class="def">op0</a> :: a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[] a <a href="src/Numeric.Backprop.Op.html#op0" class="link">Source</a> <a href="#v:op0" class="selflink">#</a></p><div class="doc"><p>Create an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> that takes no inputs and always returns the given
 value.</p><p>There is no gradient, of course (using <code><a href="Numeric-Backprop-Op.html#v:gradOp">gradOp</a></code> will give you an empty
 tuple), because there is no input to have a gradient of.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>runOp (op0 10) &#216;
</code></strong>(10, &#216;)
</pre><p>For a constant <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> that takes input and ignores it, see <code><a href="Numeric-Backprop.html#v:opConst">opConst</a></code> and
 <code><a href="Numeric-Backprop.html#v:opConst-39-">opConst'</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:opConst" class="def">opConst</a> :: (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> as, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> as) =&gt; a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="src/Numeric.Backprop.Op.html#opConst" class="link">Source</a> <a href="#v:opConst" class="selflink">#</a></p><div class="doc"><p>An <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> that ignores all of its inputs and returns a given constant
 value.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>gradOp' (opConst 10) (1 ::&lt; 2 ::&lt; 3 ::&lt; &#216;)
</code></strong>(10, 0 ::&lt; 0 ::&lt; 0 ::&lt; &#216;)
</pre></div></div><div class="top"><p class="src"><a id="v:idOp" class="def">idOp</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> '[a] a <a href="src/Numeric.Backprop.Op.html#idOp" class="link">Source</a> <a href="#v:idOp" class="selflink">#</a></p><div class="doc"><p>An <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> that just returns whatever it receives.  The identity
 function.</p><pre><code><a href="Numeric-Backprop.html#v:idOp">idOp</a></code> = <code><a href="Numeric-Backprop.html#v:opIso">opIso</a></code> <code><a href="../base-4.10.1.0/Data-Function.html#v:id">id</a></code> <code><a href="../base-4.10.1.0/Data-Function.html#v:id">id</a></code>
</pre></div></div><div class="top"><p class="src"><a id="v:opConst-39-" class="def">opConst'</a> :: <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> as =&gt; <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> as -&gt; a -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> as a <a href="src/Numeric.Backprop.Op.html#opConst%27" class="link">Source</a> <a href="#v:opConst-39-" class="selflink">#</a></p><div class="doc"><p>A version of <code><a href="Numeric-Backprop.html#v:opConst">opConst</a></code> taking explicit <code><a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a></code>, indicating the
 number of inputs and their types.</p><p>Requiring an explicit <code><a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a></code> is mostly useful for rare &quot;extremely
 polymorphic&quot; situations, where GHC can't infer the type and length of
 the the expected input tuple.  If you ever actually explicitly write
 down <code>as</code> as a list of types, you should be able to just use
 <code><a href="Numeric-Backprop.html#v:opConst">opConst</a></code>.</p></div></div><h3 id="g:7">Giving gradients directly</h3><div class="top"><p class="src"><a id="v:op1" class="def">op1</a> :: (a -&gt; (b, b -&gt; a)) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a] b <a href="src/Numeric.Backprop.Op.html#op1" class="link">Source</a> <a href="#v:op1" class="selflink">#</a></p><div class="doc"><p>Create an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> of a function taking one input, by giving its explicit
 derivative.  The function should return a tuple containing the result of
 the function, and also a function taking the derivative of the result
 and return the derivative of the input.</p><p>If we have</p><p>\[
 \eqalign{
 f &amp;: \mathbb{R} \rightarrow \mathbb{R}\cr
 y &amp;= f(x)\cr
 z &amp;= g(y)
 }
 \]</p><p>Then the derivative \( \frac{dz}{dx} \), it would be:</p><p>\[
 \frac{dz}{dx} = \frac{dz}{dy} \frac{dy}{dx}
 \]</p><p>If our <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> represents \(f\), then the second item in the resulting
 tuple should be a function that takes \(\frac{dz}{dy}\) and returns
 \(\frac{dz}{dx}\).</p><p>As an example, here is an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> that squares its input:</p><pre>square :: Num a =&gt; <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> '[a] a
square = <code><a href="Numeric-Backprop.html#v:op1-39-">op1'</a></code> $ \x -&gt; (x*x, \d -&gt; 2 * d * x
                      )
</pre><p>Remember that, generally, end users shouldn't directly construct <code><a href="Numeric-Backprop.html#t:Op">Op</a></code>s;
 they should be provided by libraries or generated automatically.</p><p>For numeric functions, single-input <code><a href="Numeric-Backprop.html#t:Op">Op</a></code>s can be generated automatically
 using <code><a href="Numeric-Backprop.html#v:op1-39-">op1'</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:op2" class="def">op2</a> :: (a -&gt; b -&gt; (c, c -&gt; (a, b))) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a, b] c <a href="src/Numeric.Backprop.Op.html#op2" class="link">Source</a> <a href="#v:op2" class="selflink">#</a></p><div class="doc"><p>Create an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> of a function taking two inputs, by giving its explicit
 gradient.  The function should return a tuple containing the result of
 the function, and also a function taking the derivative of the result
 and return the derivative of the input.</p><p>If we have</p><p>\[
 \eqalign{
 f &amp;: \mathbb{R}^2 \rightarrow \mathbb{R}\cr
 z &amp;= f(x, y)\cr
 k &amp;= g(z)
 }
 \]</p><p>Then the gradient \( \left&lt; \frac{\partial k}{\partial x}, \frac{\partial k}{\partial y} \right&gt; \)
 would be:</p><p>\[
 \left&lt; \frac{\partial k}{\partial x}, \frac{\partial k}{\partial y} \right&gt; =
  \left&lt; \frac{dk}{dz} \frac{\partial z}{dx}, \frac{dk}{dz} \frac{\partial z}{dy} \right&gt;
 \]</p><p>If our <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> represents \(f\), then the second item in the resulting
 tuple should be a function that takes \(\frac{dk}{dz}\) and returns
 \( \left&lt; \frac{\partial k}{dx}, \frac{\partial k}{dx} \right&gt; \).</p><p>As an example, here is an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> that multiplies its inputs:</p><pre>mul :: Num a =&gt; <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> '[a, a] a
mul = <code><a href="Numeric-Backprop.html#v:op2-39-">op2'</a></code> $ \x y -&gt; (x*y, \d -&gt; (d*y, x*d)
                     )
</pre><p>Remember that, generally, end users shouldn't directly construct <code><a href="Numeric-Backprop.html#t:Op">Op</a></code>s;
 they should be provided by libraries or generated automatically.</p><p>For numeric functions, two-input <code><a href="Numeric-Backprop.html#t:Op">Op</a></code>s can be generated automatically
 using <code><a href="Numeric-Backprop.html#v:op2-39-">op2'</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:op3" class="def">op3</a> :: (a -&gt; b -&gt; c -&gt; (d, d -&gt; (a, b, c))) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a, b, c] d <a href="src/Numeric.Backprop.Op.html#op3" class="link">Source</a> <a href="#v:op3" class="selflink">#</a></p><div class="doc"><p>Create an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> of a function taking three inputs, by giving its explicit
 gradient.  See documentation for <code><a href="Numeric-Backprop.html#v:op2">op2</a></code> for more details.</p></div></div><h3 id="g:8">Automatic creation using the <em>ad</em> library</h3><div class="top"><p class="src"><a id="v:op1-39-" class="def">op1'</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a =&gt; (<span class="keyword">forall</span> s. <a href="../ad-4.3.5/Numeric-AD-Internal-Type.html#t:AD">AD</a> s (<a href="../ad-4.3.5/Numeric-AD-Rank1-Forward.html#t:Forward">Forward</a> a) -&gt; <a href="../ad-4.3.5/Numeric-AD-Internal-Type.html#t:AD">AD</a> s (<a href="../ad-4.3.5/Numeric-AD-Rank1-Forward.html#t:Forward">Forward</a> a)) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a] a <a href="src/Numeric.Backprop.Op.html#op1%27" class="link">Source</a> <a href="#v:op1-39-" class="selflink">#</a></p><div class="doc"><p>Automatically create an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> of a numerical function taking one
 argument.  Uses <code><a href="../ad-4.3.5/Numeric-AD-Mode-Forward.html#v:diff">diff</a></code>, and so can take any numerical
 function polymorphic over the standard numeric types.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>gradOp' (op1' (recip . negate)) (5 ::&lt; &#216;)
</code></strong>(-0.2, 0.04 ::&lt; &#216;)
</pre></div></div><div class="top"><p class="src"><a id="v:op2-39-" class="def">op2'</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a =&gt; (<span class="keyword">forall</span> s. <a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="../ad-4.3.5/Numeric-AD-Internal-Reverse.html#t:Tape">Tape</a> =&gt; <a href="../ad-4.3.5/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a -&gt; <a href="../ad-4.3.5/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a -&gt; <a href="../ad-4.3.5/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a, a] a <a href="src/Numeric.Backprop.Op.html#op2%27" class="link">Source</a> <a href="#v:op2-39-" class="selflink">#</a></p><div class="doc"><p>Automatically create an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> of a numerical function taking two
 arguments.  Uses <code><a href="../ad-4.3.5/Numeric-AD-Mode-Reverse.html#v:grad">grad</a></code>, and so can take any numerical function
 polymorphic over the standard numeric types.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>gradOp' (op2' (\x y -&gt; x * sqrt y)) (3 ::&lt; 4 ::&lt; &#216;)
</code></strong>(6.0, 2.0 ::&lt; 0.75 ::&lt; &#216;)
</pre></div></div><div class="top"><p class="src"><a id="v:op3-39-" class="def">op3'</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a =&gt; (<span class="keyword">forall</span> s. <a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="../ad-4.3.5/Numeric-AD-Internal-Reverse.html#t:Tape">Tape</a> =&gt; <a href="../ad-4.3.5/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a -&gt; <a href="../ad-4.3.5/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a -&gt; <a href="../ad-4.3.5/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a -&gt; <a href="../ad-4.3.5/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a, a, a] a <a href="src/Numeric.Backprop.Op.html#op3%27" class="link">Source</a> <a href="#v:op3-39-" class="selflink">#</a></p><div class="doc"><p>Automatically create an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> of a numerical function taking three
 arguments.  Uses <code><a href="../ad-4.3.5/Numeric-AD-Mode-Reverse.html#v:grad">grad</a></code>, and so can take any numerical function
 polymorphic over the standard numeric types.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>gradOp' (op3' (\x y z -&gt; (x * sqrt y)**z)) (3 ::&lt; 4 ::&lt; 2 ::&lt; &#216;)
</code></strong>(36.0, 24.0 ::&lt; 9.0 ::&lt; 64.503 ::&lt; &#216;)
</pre></div></div><div class="top"><p class="src"><a id="v:opN-39-" class="def">opN'</a> :: (<a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Nat.html#t:Nat">Nat</a> n) =&gt; (<span class="keyword">forall</span> s. <a href="../reflection-2.1.3/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="../ad-4.3.5/Numeric-AD-Internal-Reverse.html#t:Tape">Tape</a> =&gt; <a href="../type-combinators-0.2.4.3/Data-Type-Vector.html#t:Vec">Vec</a> n (<a href="../ad-4.3.5/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a) -&gt; <a href="../ad-4.3.5/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> (<a href="Numeric-Backprop.html#t:Replicate">Replicate</a> n a) a <a href="src/Numeric.Backprop.Op.html#opN%27" class="link">Source</a> <a href="#v:opN-39-" class="selflink">#</a></p><div class="doc"><p>Automatically create an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> of a numerical function taking multiple
 arguments.  Uses <code><a href="../ad-4.3.5/Numeric-AD-Mode-Reverse.html#v:grad">grad</a></code>, and so can take any numerical
 function polymorphic over the standard numeric types.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>gradOp' (opN' (\(x :+ y :+ &#216;) -&gt; x * sqrt y)) (3 ::&lt; 4 ::&lt; &#216;)
</code></strong>(6.0, 2.0 ::&lt; 0.75 ::&lt; &#216;)
</pre></div></div><div class="top"><p class="src"><span class="keyword">type family</span> <a id="t:Replicate" class="def">Replicate</a> (n :: <a href="../type-combinators-0.2.4.3/Type-Family-Nat.html#t:N">N</a>) (a :: k) = (as :: [k]) | as -&gt; n <span class="keyword">where ...</span> <a href="src/Data.Type.Util.html#Replicate" class="link">Source</a> <a href="#t:Replicate" class="selflink">#</a></p><div class="doc"><p><code><code><a href="Numeric-Backprop.html#t:Replicate">Replicate</a></code> n a</code> is a list of <code>a</code>s repeated <code>n</code> times.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>:kind! Replicate N3 Int
</code></strong>'[Int, Int, Int]
<code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>:kind! Replicate N5 Double
</code></strong>'[Double, Double, Double, Double, Double]
</pre></div><div class="subs equations"><p class="caption">Equations</p><table><tr><td class="src"><a href="Numeric-Backprop.html#t:Replicate">Replicate</a> <a href="../type-combinators-0.2.4.3/Type-Family-Nat.html#v:Z">Z</a> a = '[]</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Numeric-Backprop.html#t:Replicate">Replicate</a> (<a href="../type-combinators-0.2.4.3/Type-Family-Nat.html#v:S">S</a> n) a = a ': <a href="Numeric-Backprop.html#t:Replicate">Replicate</a> n a</td><td class="doc empty">&nbsp;</td></tr></table></div></div><h3 id="g:9">From Isomorphisms</h3><div class="top"><p class="src"><a id="v:opCoerce" class="def">opCoerce</a> :: <a href="../base-4.10.1.0/Data-Coerce.html#t:Coercible">Coercible</a> a b =&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a] b <a href="src/Numeric.Backprop.Op.html#opCoerce" class="link">Source</a> <a href="#v:opCoerce" class="selflink">#</a></p><div class="doc"><p>An <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> that coerces an item into another item whose type has the same
 runtime representation.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>gradOp' opCoerce (Identity 5) :: (Int, Identity Int)
</code></strong>(5, Identity 1)
</pre><pre><code><a href="Numeric-Backprop.html#v:opCoerce">opCoerce</a></code> = <code><a href="Numeric-Backprop.html#v:opIso">opIso</a></code> <code>coerced</code> <code><a href="../base-4.10.1.0/Data-Coerce.html#v:coerce">coerce</a></code>
</pre></div></div><div class="top"><p class="src"><a id="v:opTup" class="def">opTup</a> :: <a href="Numeric-Backprop.html#t:Op">Op</a> as (<a href="Numeric-Backprop-Op.html#t:Tuple">Tuple</a> as) <a href="src/Numeric.Backprop.Op.html#opTup" class="link">Source</a> <a href="#v:opTup" class="selflink">#</a></p><div class="doc"><p>An <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> that takes <code>as</code> and returns exactly the input tuple.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>gradOp' opTup (1 ::&lt; 2 ::&lt; 3 ::&lt; &#216;)
</code></strong>(1 ::&lt; 2 ::&lt; 3 ::&lt; &#216;, 1 ::&lt; 1 ::&lt; 1 ::&lt; &#216;)
</pre></div></div><div class="top"><p class="src"><a id="v:opIso" class="def">opIso</a> :: (a -&gt; b) -&gt; (b -&gt; a) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a] b <a href="src/Numeric.Backprop.Op.html#opIso" class="link">Source</a> <a href="#v:opIso" class="selflink">#</a></p><div class="doc"><p>An <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> that runs the input value through an isomorphism.</p><p>Warning: This is unsafe!  It assumes that the isomorphisms themselves
 have derivative 1, so will break for things like
 <code><a href="Numeric-Lens.html#v:exponentiating">exponentiating</a></code>.  Basically, don't use this for any
 &quot;numeric&quot; isomorphisms.</p></div></div><div class="top"><p class="src"><a id="v:opLens" class="def">opLens</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a =&gt; <a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens-39-">Lens'</a> a b -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a] b <a href="src/Numeric.Backprop.Op.html#opLens" class="link">Source</a> <a href="#v:opLens" class="selflink">#</a></p><div class="doc"><p>An <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> that extracts a value from an input value using a <code><a href="../microlens-0.4.8.3/Lens-Micro-Type.html#t:Lens-39-">Lens'</a></code>.</p><p>Warning: This is unsafe!  It assumes that it extracts a specific value
 unchanged, with derivative 1, so will break for things that numerically
 manipulate things before returning them.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.18.1</p></div></body></html>
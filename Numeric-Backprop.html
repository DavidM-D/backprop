<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Numeric.Backprop</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Numeric-Backprop.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Numeric.Backprop.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">backprop-0.1.0.0: Graph-based, heterogeneous, type-safe backpropagation in
Haskell</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Numeric.Backprop</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Types</a><ul><li><a href="#g:2">Backprop Types</a></li><li><a href="#g:3">Utility types</a></li></ul></li><li><a href="#g:4">BP</a><ul><li><a href="#g:5">Backprop</a></li><li><a href="#g:6">Utility combinators</a></li></ul></li><li><a href="#g:7">Refs</a><ul><li><a href="#g:8">From Ops</a></li><li><a href="#g:9">Ref manipulation</a><ul><li><a href="#g:10">As parts</a></li><li><a href="#g:11">As sums</a></li><li><a href="#g:12">As sums of products</a></li></ul></li><li><a href="#g:13">Transforming BP</a></li><li><a href="#g:14">Combining</a></li></ul></li><li><a href="#g:15">Op</a></li><li><a href="#g:16">Utility</a></li></ul></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span> <a href="#t:BP">BP</a> s rs b</li><li class="src short"><span class="keyword">type</span> <a href="#t:BPOp">BPOp</a> s rs a = <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a)</li><li class="src short"><span class="keyword">type</span> <a href="#t:BPOpI">BPOpI</a> s rs a = <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) rs -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a</li><li class="src short"><span class="keyword">data</span> <a href="#t:BVar">BVar</a> :: <a href="../base-4.9.1.0/Data-Kind.html#t:Type">Type</a> -&gt; [<a href="../base-4.9.1.0/Data-Kind.html#t:Type">Type</a>] -&gt; <a href="../base-4.9.1.0/Data-Kind.html#t:Type">Type</a> -&gt; <a href="../base-4.9.1.0/Data-Kind.html#t:Type">Type</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:Op">Op</a> as a = <span class="keyword">forall</span> m. <a href="../base-4.9.1.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Numeric-Backprop-Op.html#t:OpM">OpM</a> m as a</li><li class="src short"><span class="keyword">type</span> <a href="#t:OpB">OpB</a> s as a = <a href="Numeric-Backprop-Op.html#t:OpM">OpM</a> (<a href="../base-4.9.1.0/Control-Monad-ST.html#t:ST">ST</a> s) as a</li><li class="src short"><span class="keyword">data</span> <a href="#t:Prod">Prod</a> k f a :: <span class="keyword">forall</span> k. (k -&gt; <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a>) -&gt; [k] -&gt; <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> <span class="keyword">where</span><ul class="subs"><li><a href="#v:-216-">&#216;</a> :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f ([] k)</li><li><a href="#v::-60-">(:&lt;)</a> :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f ((:) k a1 as)</li></ul></li><li class="src short"><span class="keyword">type</span> <a href="#t:Tuple">Tuple</a> = <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> <a href="../type-combinators-0.2.4.3/Data-Type-Combinator.html#t:I">I</a></li><li class="src short"><span class="keyword">newtype</span> <a href="#t:Summer">Summer</a> a = <a href="#v:Summer">Summer</a> {<ul class="subs"><li><a href="#v:runSummer">runSummer</a> :: [a] -&gt; a</li></ul>}</li><li class="src short"><span class="keyword">newtype</span> <a href="#t:Unity">Unity</a> a = <a href="#v:Unity">Unity</a> {<ul class="subs"><li><a href="#v:getUnity">getUnity</a> :: a</li></ul>}</li><li class="src short"><a href="#v:backprop">backprop</a> :: <span class="keyword">forall</span> rs a. <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> rs =&gt; (<span class="keyword">forall</span> s. <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s rs a) -&gt; <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> rs -&gt; (a, <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> rs)</li><li class="src short"><a href="#v:evalBPOp">evalBPOp</a> :: <span class="keyword">forall</span> rs a. <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> rs =&gt; (<span class="keyword">forall</span> s. <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s rs a) -&gt; <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> rs -&gt; a</li><li class="src short"><a href="#v:gradBPOp">gradBPOp</a> :: <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> rs =&gt; (<span class="keyword">forall</span> s. <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s rs a) -&gt; <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> rs -&gt; <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> rs</li><li class="src short"><a href="#v:backprop-39-">backprop'</a> :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> rs -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> rs -&gt; (<span class="keyword">forall</span> s. <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s rs a) -&gt; <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> rs -&gt; (a, <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> rs)</li><li class="src short"><a href="#v:evalBPOp-39-">evalBPOp'</a> :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> rs -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> rs -&gt; (<span class="keyword">forall</span> s. <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s rs a) -&gt; <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> rs -&gt; a</li><li class="src short"><a href="#v:gradBPOp-39-">gradBPOp'</a> :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> rs -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> rs -&gt; (<span class="keyword">forall</span> s. <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s rs a) -&gt; <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> rs -&gt; <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> rs</li><li class="src short"><a href="#v:withInps">withInps</a> :: <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> rs =&gt; (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) rs -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a) -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a</li><li class="src short"><a href="#v:implicitly">implicitly</a> :: <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> rs =&gt; <a href="Numeric-Backprop.html#t:BPOpI">BPOpI</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s rs a</li><li class="src short"><a href="#v:withInps-39-">withInps'</a> :: <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> rs -&gt; (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) rs -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a) -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a</li><li class="src short"><a href="#v:implicitly-39-">implicitly'</a> :: <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> rs -&gt; <a href="Numeric-Backprop.html#t:BPOpI">BPOpI</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s rs a</li><li class="src short"><a href="#v:constRef">constRef</a> :: a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a</li><li class="src short"><a href="#v:inpRef">inpRef</a> :: <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Index">Index</a> rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a</li><li class="src short"><a href="#v:inpRefs">inpRefs</a> :: <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> rs =&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) rs</li><li class="src short"><a href="#v:bpOp">bpOp</a> :: (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> as, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> as) =&gt; <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s as a -&gt; <a href="Numeric-Backprop.html#t:OpB">OpB</a> s as a</li><li class="src short"><a href="#v:bindRef">bindRef</a> :: <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a)</li><li class="src short"><a href="#v:inpRefs-39-">inpRefs'</a> :: <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> rs -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) rs</li><li class="src short"><a href="#v:bpOp-39-">bpOp'</a> :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> as -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> as -&gt; <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s as a -&gt; <a href="Numeric-Backprop.html#t:OpB">OpB</a> s as a</li><li class="src short"><a href="#v:bindRef-39-">bindRef'</a> :: <a href="Numeric-Backprop.html#t:Summer">Summer</a> a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a)</li><li class="src short"><a href="#v:opRef">opRef</a> :: <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a =&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) as -&gt; <a href="Numeric-Backprop.html#t:OpB">OpB</a> s as a -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a)</li><li class="src short"><a href="#v:-126--36-">(~$)</a> :: <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a =&gt; <a href="Numeric-Backprop.html#t:OpB">OpB</a> s as a -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) as -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a)</li><li class="src short"><a href="#v:opRef1">opRef1</a> :: <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> b =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:OpB">OpB</a> s '[a] b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b)</li><li class="src short"><a href="#v:opRef2">opRef2</a> :: <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> c =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:OpB">OpB</a> s '[a, b] c -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs c)</li><li class="src short"><a href="#v:opRef3">opRef3</a> :: <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> d =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs c -&gt; <a href="Numeric-Backprop.html#t:OpB">OpB</a> s '[a, b, c] d -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs d)</li><li class="src short"><a href="#v:-45--36-">(-$)</a> :: (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> as, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> as, <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a) =&gt; <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s as a -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) as -&gt; <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s rs a</li><li class="src short"><a href="#v:-45--38-">(-&amp;)</a> :: (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> as, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> as, <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a) =&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) as -&gt; (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s as) as -&gt; <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s as a) -&gt; <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s rs a</li><li class="src short"><a href="#v:opRef-39-">opRef'</a> :: <span class="keyword">forall</span> s rs as a. <a href="Numeric-Backprop.html#t:Summer">Summer</a> a -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) as -&gt; <a href="Numeric-Backprop.html#t:OpB">OpB</a> s as a -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a)</li><li class="src short"><a href="#v:opRef1-39-">opRef1'</a> :: <a href="Numeric-Backprop.html#t:Summer">Summer</a> b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:OpB">OpB</a> s '[a] b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b)</li><li class="src short"><a href="#v:opRef2-39-">opRef2'</a> :: <a href="Numeric-Backprop.html#t:Summer">Summer</a> c -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:OpB">OpB</a> s '[a, b] c -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs c)</li><li class="src short"><a href="#v:opRef3-39-">opRef3'</a> :: <a href="Numeric-Backprop.html#t:Summer">Summer</a> d -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs c -&gt; <a href="Numeric-Backprop.html#t:OpB">OpB</a> s '[a, b, c] d -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs d)</li><li class="src short"><a href="#v:partsRef">partsRef</a> :: <span class="keyword">forall</span> s rs bs b. (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> bs, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> bs) =&gt; <a href="Numeric-Backprop-Iso.html#t:Iso-39-">Iso'</a> b (<a href="Numeric-Backprop.html#t:Tuple">Tuple</a> bs) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) bs)</li><li class="src short"><a href="#v:-35--60--126-">(#&lt;~)</a> :: (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> bs, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> bs) =&gt; <a href="Numeric-Backprop-Iso.html#t:Iso-39-">Iso'</a> b (<a href="Numeric-Backprop.html#t:Tuple">Tuple</a> bs) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) bs)</li><li class="src short"><a href="#v:withParts">withParts</a> :: (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> bs, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> bs) =&gt; <a href="Numeric-Backprop-Iso.html#t:Iso-39-">Iso'</a> b (<a href="Numeric-Backprop.html#t:Tuple">Tuple</a> bs) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) bs -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a) -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a</li><li class="src short"><a href="#v:splitRefs">splitRefs</a> :: <span class="keyword">forall</span> s rs as. (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> as, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> as) =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs (<a href="Numeric-Backprop.html#t:Tuple">Tuple</a> as) -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) as)</li><li class="src short"><a href="#v:gSplit">gSplit</a> :: (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> bs, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> bs, <a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Generic">Generic</a> b, <a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Code">Code</a> b ~ '[bs]) =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) bs)</li><li class="src short"><a href="#v:partsRef-39-">partsRef'</a> :: <span class="keyword">forall</span> s rs bs b. <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> bs -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> bs -&gt; <a href="Numeric-Backprop-Iso.html#t:Iso-39-">Iso'</a> b (<a href="Numeric-Backprop.html#t:Tuple">Tuple</a> bs) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) bs)</li><li class="src short"><a href="#v:withParts-39-">withParts'</a> :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> bs -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> bs -&gt; <a href="Numeric-Backprop-Iso.html#t:Iso-39-">Iso'</a> b (<a href="Numeric-Backprop.html#t:Tuple">Tuple</a> bs) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) bs -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a) -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a</li><li class="src short"><a href="#v:splitRefs-39-">splitRefs'</a> :: <span class="keyword">forall</span> s rs as. <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> as -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> as -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs (<a href="Numeric-Backprop.html#t:Tuple">Tuple</a> as) -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) as)</li><li class="src short"><a href="#v:gSplit-39-">gSplit'</a> :: (<a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Generic">Generic</a> b, <a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Code">Code</a> b ~ '[bs]) =&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> bs -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> bs -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) bs)</li><li class="src short"><a href="#v:choicesRef">choicesRef</a> :: <span class="keyword">forall</span> s rs bs b. (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> bs, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> bs) =&gt; <a href="Numeric-Backprop-Iso.html#t:Iso-39-">Iso'</a> b (<a href="../type-combinators-0.2.4.3/Data-Type-Sum.html#t:Sum">Sum</a> <a href="../type-combinators-0.2.4.3/Data-Type-Combinator.html#t:I">I</a> bs) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="../type-combinators-0.2.4.3/Data-Type-Sum.html#t:Sum">Sum</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) bs)</li><li class="src short"><a href="#v:choicesRef-39-">choicesRef'</a> :: <span class="keyword">forall</span> s rs bs b. <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> bs -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> bs -&gt; <a href="Numeric-Backprop-Iso.html#t:Iso-39-">Iso'</a> b (<a href="../type-combinators-0.2.4.3/Data-Type-Sum.html#t:Sum">Sum</a> <a href="../type-combinators-0.2.4.3/Data-Type-Combinator.html#t:I">I</a> bs) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="../type-combinators-0.2.4.3/Data-Type-Sum.html#t:Sum">Sum</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) bs)</li><li class="src short"><a href="#v:sopRef">sopRef</a> :: <span class="keyword">forall</span> s rs bss b. (<a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> bss, <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> <a href="../type-combinators-0.2.4.3/Type-Class-Witness.html#t:-8743-">&#8743;</a> <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a>) bss) =&gt; <a href="Numeric-Backprop-Iso.html#t:Iso-39-">Iso'</a> b (<a href="../type-combinators-0.2.4.3/Data-Type-Sum.html#t:Sum">Sum</a> <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> bss) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="../type-combinators-0.2.4.3/Data-Type-Sum.html#t:Sum">Sum</a> (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs)) bss)</li><li class="src short"><a href="#v:gSplits">gSplits</a> :: <span class="keyword">forall</span> s rs b. (<a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Generic">Generic</a> b, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> (<a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Code">Code</a> b), <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> <a href="../type-combinators-0.2.4.3/Type-Class-Witness.html#t:-8743-">&#8743;</a> <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a>) (<a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Code">Code</a> b)) =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="../type-combinators-0.2.4.3/Data-Type-Sum.html#t:Sum">Sum</a> (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs)) (<a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Code">Code</a> b))</li><li class="src short"><a href="#v:sopRef-39-">sopRef'</a> :: <span class="keyword">forall</span> s rs bss b. <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a>) bss -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a>) bss -&gt; <a href="Numeric-Backprop-Iso.html#t:Iso-39-">Iso'</a> b (<a href="../type-combinators-0.2.4.3/Data-Type-Sum.html#t:Sum">Sum</a> <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> bss) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="../type-combinators-0.2.4.3/Data-Type-Sum.html#t:Sum">Sum</a> (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs)) bss)</li><li class="src short"><a href="#v:gSplits-39-">gSplits'</a> :: <span class="keyword">forall</span> s rs b. <a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Generic">Generic</a> b =&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a>) (<a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Code">Code</a> b) -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a>) (<a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Code">Code</a> b) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="../type-combinators-0.2.4.3/Data-Type-Sum.html#t:Sum">Sum</a> (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs)) (<a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Code">Code</a> b))</li><li class="src short"><a href="#v:internally">internally</a> :: <span class="keyword">forall</span> s rs bs b a. (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> bs, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> bs, <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a) =&gt; <a href="Numeric-Backprop-Iso.html#t:Iso-39-">Iso'</a> b (<a href="Numeric-Backprop.html#t:Tuple">Tuple</a> bs) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s bs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s bs a) -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a)</li><li class="src short"><a href="#v:generically">generically</a> :: <span class="keyword">forall</span> s rs bs b a. (<a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a, <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> bs, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> bs, <a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Generic">Generic</a> b, <a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Code">Code</a> b ~ '[bs]) =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s bs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s bs a) -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a)</li><li class="src short"><a href="#v:internally-39-">internally'</a> :: <span class="keyword">forall</span> s rs bs b a. <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> bs -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> bs -&gt; <a href="Numeric-Backprop.html#t:Summer">Summer</a> a -&gt; <a href="Numeric-Backprop-Iso.html#t:Iso-39-">Iso'</a> b (<a href="Numeric-Backprop.html#t:Tuple">Tuple</a> bs) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s bs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s bs a) -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a)</li><li class="src short"><a href="#v:generically-39-">generically'</a> :: <span class="keyword">forall</span> s rs bs b a. (<a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Generic">Generic</a> b, <a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Code">Code</a> b ~ '[bs]) =&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> bs -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> bs -&gt; <a href="Numeric-Backprop.html#t:Summer">Summer</a> a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s bs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s bs a) -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a)</li><li class="src short"><a href="#v:liftR">liftR</a> :: <a href="Numeric-Backprop.html#t:OpB">OpB</a> s as a -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) as -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a</li><li class="src short"><a href="#v:liftR1">liftR1</a> :: <a href="Numeric-Backprop.html#t:OpB">OpB</a> s '[a] b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b</li><li class="src short"><a href="#v:liftR2">liftR2</a> :: <a href="Numeric-Backprop.html#t:OpB">OpB</a> s '[a, b] c -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs c</li><li class="src short"><a href="#v:liftR3">liftR3</a> :: <a href="Numeric-Backprop.html#t:OpB">OpB</a> s '[a, b, c] d -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs c -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs d</li><li class="src short"><a href="#v:op1">op1</a> :: <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a =&gt; (<span class="keyword">forall</span> s. <a href="../ad-4.3.2.1/Numeric-AD-Internal-Type.html#t:AD">AD</a> s (<a href="../ad-4.3.2.1/Numeric-AD-Rank1-Forward.html#t:Forward">Forward</a> a) -&gt; <a href="../ad-4.3.2.1/Numeric-AD-Internal-Type.html#t:AD">AD</a> s (<a href="../ad-4.3.2.1/Numeric-AD-Rank1-Forward.html#t:Forward">Forward</a> a)) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a] a</li><li class="src short"><a href="#v:op2">op2</a> :: <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a =&gt; (<span class="keyword">forall</span> s. <a href="../reflection-2.1.2/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="../ad-4.3.2.1/Numeric-AD-Internal-Reverse.html#t:Tape">Tape</a> =&gt; <a href="../ad-4.3.2.1/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a -&gt; <a href="../ad-4.3.2.1/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a -&gt; <a href="../ad-4.3.2.1/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a, a] a</li><li class="src short"><a href="#v:op3">op3</a> :: <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a =&gt; (<span class="keyword">forall</span> s. <a href="../reflection-2.1.2/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="../ad-4.3.2.1/Numeric-AD-Internal-Reverse.html#t:Tape">Tape</a> =&gt; <a href="../ad-4.3.2.1/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a -&gt; <a href="../ad-4.3.2.1/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a -&gt; <a href="../ad-4.3.2.1/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a -&gt; <a href="../ad-4.3.2.1/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a, a, a] a</li><li class="src short"><a href="#v:opN">opN</a> :: (<a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Nat.html#t:Nat">Nat</a> n) =&gt; (<span class="keyword">forall</span> s. <a href="../reflection-2.1.2/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="../ad-4.3.2.1/Numeric-AD-Internal-Reverse.html#t:Tape">Tape</a> =&gt; <a href="Numeric-Backprop-Op-Mono.html#t:Vec">Vec</a> n (<a href="../ad-4.3.2.1/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a) -&gt; <a href="../ad-4.3.2.1/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> (<a href="Numeric-Backprop-Op.html#t:Replicate">Replicate</a> n a) a</li><li class="src short"><a href="#v:op1-39-">op1'</a> :: (a -&gt; (b, <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> b -&gt; a)) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a] b</li><li class="src short"><a href="#v:op2-39-">op2'</a> :: (a -&gt; b -&gt; (c, <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> c -&gt; (a, b))) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a, b] c</li><li class="src short"><a href="#v:op3-39-">op3'</a> :: (a -&gt; b -&gt; c -&gt; (d, <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> d -&gt; (a, b, c))) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a, b, c] d</li><li class="src short"><span class="keyword">pattern</span> <a href="#v::-62-">(:&gt;)</a> :: <span class="keyword">forall</span> k f a b. f a -&gt; f b -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f ((:) k a ((:) k b ([] k)))</li><li class="src short"><a href="#v:only">only</a> :: f a -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f ((:) k a ([] k))</li><li class="src short"><a href="#v:head-39-">head'</a> :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f (<a href="../type-combinators-0.2.4.3/Type-Family-List.html#t::-60-">(:&lt;)</a> k a as) -&gt; f a</li><li class="src short"><span class="keyword">pattern</span> <a href="#v:::-60-">(::&lt;)</a> :: <span class="keyword">forall</span> a as. a -&gt; <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> as -&gt; <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> (<a href="../type-combinators-0.2.4.3/Type-Family-List.html#t::-60-">(:&lt;)</a> <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> a as)</li><li class="src short"><a href="#v:only_">only_</a> :: a -&gt; <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> ((:) <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> a ([] <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a>))</li><li class="src short"><a href="#v:summers">summers</a> :: (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> as, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> as) =&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> as</li><li class="src short"><a href="#v:unities">unities</a> :: (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> as, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> as) =&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> as</li><li class="src short"><a href="#v:summers-39-">summers'</a> :: <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> as =&gt; <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> as -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> as</li><li class="src short"><a href="#v:unities-39-">unities'</a> :: <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> as =&gt; <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> as -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> as</li></ul></div><div id="interface"><h1 id="g:1">Types</h1><h2 id="g:2">Backprop Types</h2><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:BP" class="def">BP</a> s rs b <a href="src/Numeric.Backprop.Internal.html#BP" class="link">Source</a> <a href="#t:BP" class="selflink">#</a></p><div class="doc"><p>A Monad allowing you to explicitly build hetereogeneous data
 dependency graphs and that the library can perform backpropagation on.</p><p>A <code><code><a href="Numeric-Backprop.html#t:BP">BP</a></code> s rs b</code> is a <code><a href="Numeric-Backprop.html#t:BP">BP</a></code> action that uses an environment of <code>rs</code>
 returning a <code>b</code>.  When &quot;run&quot;, it will compute a gradient that is a tuple
 of <code>rs</code>.  (The phantom parameter <code>s</code> is used to ensure that any <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s
 aren't leaked out of the monad)</p><p>Note that you can only &quot;run&quot; a <code><code><a href="Numeric-Backprop.html#t:BP">BP</a></code> s rs</code> that produces a <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> --
 that is, things of the form</p><pre><code><a href="Numeric-Backprop.html#t:BP">BP</a></code> s rs (<code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> rs a)
</pre><p>The above is a <code><a href="Numeric-Backprop.html#t:BP">BP</a></code> action that returns a <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> containing an <code>a</code>.
 When this is run, it'll produce a result of type <code>a</code> and a gradient of
 that is a tuple of <code>rs</code>.  (This form has a type synonym,
 <code><a href="Numeric-Backprop.html#v:BPOp">BPOp</a></code>, for convenience)</p><p>For example, a <code><code><a href="Numeric-Backprop.html#t:BP">BP</a></code> s '[ Int, Double, Double ]</code> is a monad that
 represents a computation with an <code><a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></code>, <code><a href="../base-4.9.1.0/Prelude.html#t:Double">Double</a></code>, and <code><a href="../base-4.9.1.0/Prelude.html#t:Double">Double</a></code> as
 inputs.   And, if you ran a</p><pre><code><a href="Numeric-Backprop.html#t:BP">BP</a></code> s '[ Int, Double, Double ] (<code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> '[ Int, Double, Double ] Double)
</pre><p>Or, using the <code>BPOp</code> type synonym:</p><pre><code><a href="Numeric-Backprop.html#v:BPOp">BPOp</a></code> s '[ Int, Double, Double ] (<code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> rs Double)
</pre><p>with <code><a href="Numeric-Backprop.html#v:backprop">backprop</a></code> or <code><a href="Numeric-Backprop.html#v:gradBPOp">gradBPOp</a></code>, it'll
 return a gradient on the inputs (<code><a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></code>, <code><a href="../base-4.9.1.0/Prelude.html#t:Double">Double</a></code>, and <code><a href="../base-4.9.1.0/Prelude.html#t:Double">Double</a></code>) and
 produce a value of type <code><a href="../base-4.9.1.0/Prelude.html#t:Double">Double</a></code>.</p></div><div class="subs instances"><p id="control.i:BP" class="caption collapser" onclick="toggleSection('i:BP')">Instances</p><div id="section.i:BP" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:BP:Monad:1" class="instance expander" onclick="toggleSection('i:id:BP:Monad:1')"></span> <a href="../base-4.9.1.0/Control-Monad.html#t:Monad">Monad</a> (<a href="Numeric-Backprop.html#t:BP">BP</a> s rs)</span> <a href="src/Numeric.Backprop.Internal.html#line-145" class="link">Source</a> <a href="#t:BP" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:BP:Monad:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-62--62--61-">(&gt;&gt;=)</a> :: <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a -&gt; (a -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs b) -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs b <a href="#v:-62--62--61-" class="selflink">#</a></p><p class="src"><a href="#v:-62--62-">(&gt;&gt;)</a> :: <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs b <a href="#v:-62--62-" class="selflink">#</a></p><p class="src"><a href="#v:return">return</a> :: a -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a <a href="#v:return" class="selflink">#</a></p><p class="src"><a href="#v:fail">fail</a> :: <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a <a href="#v:fail" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:BP:Functor:2" class="instance expander" onclick="toggleSection('i:id:BP:Functor:2')"></span> <a href="../base-4.9.1.0/Data-Functor.html#t:Functor">Functor</a> (<a href="Numeric-Backprop.html#t:BP">BP</a> s rs)</span> <a href="src/Numeric.Backprop.Internal.html#line-143" class="link">Source</a> <a href="#t:BP" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:BP:Functor:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fmap">fmap</a> :: (a -&gt; b) -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs b <a href="#v:fmap" class="selflink">#</a></p><p class="src"><a href="#v:-60--36-">(&lt;$)</a> :: a -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a <a href="#v:-60--36-" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:BP:Applicative:3" class="instance expander" onclick="toggleSection('i:id:BP:Applicative:3')"></span> <a href="../base-4.9.1.0/Control-Applicative.html#t:Applicative">Applicative</a> (<a href="Numeric-Backprop.html#t:BP">BP</a> s rs)</span> <a href="src/Numeric.Backprop.Internal.html#line-144" class="link">Source</a> <a href="#t:BP" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:BP:Applicative:3" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:pure">pure</a> :: a -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a <a href="#v:pure" class="selflink">#</a></p><p class="src"><a href="#v:-60--42--62-">(&lt;*&gt;)</a> :: <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (a -&gt; b) -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs b <a href="#v:-60--42--62-" class="selflink">#</a></p><p class="src"><a href="#v:-42--62-">(*&gt;)</a> :: <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs b <a href="#v:-42--62-" class="selflink">#</a></p><p class="src"><a href="#v:-60--42-">(&lt;*)</a> :: <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a <a href="#v:-60--42-" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:BPOp" class="def">BPOp</a> s rs a = <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a) <a href="src/Numeric.Backprop.html#BPOp" class="link">Source</a> <a href="#t:BPOp" class="selflink">#</a></p><div class="doc"><p>A handy type synonym representing a <code><a href="Numeric-Backprop.html#t:BP">BP</a></code> action that returns a <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>.
 This is handy because this is the form of <code><a href="Numeric-Backprop.html#t:BP">BP</a></code> actions that
 <code><a href="Numeric-Backprop.html#v:backprop">backprop</a></code> and <code><a href="Numeric-Backprop.html#v:gradBPOp">gradBPOp</a></code> (etc.) expects.</p><p>A value of type:</p><pre><code><a href="Numeric-Backprop.html#t:BPOp">BPOp</a></code> s rs a
</pre><p>is an action that takes an input environment of <code>rs</code> and produces
 a <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> containing a value of type <code>a</code>.  Because it returns a <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>,
 the library can track the data dependencies between the <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> and the
 input environment and perform backpropagation.</p><p>See documentation for <code><a href="Numeric-Backprop.html#t:BP">BP</a></code> for an explanation of the phantom type
 parameter <code>s</code>.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:BPOpI" class="def">BPOpI</a> s rs a = <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) rs -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="src/Numeric.Backprop.html#BPOpI" class="link">Source</a> <a href="#t:BPOpI" class="selflink">#</a></p><div class="doc"><p>An &quot;implicit&quot; operation on <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s that can be backpropagated.
 A value of type:</p><pre><code><a href="Numeric-Backprop.html#t:BPOpI">BPOpI</a></code> s rs a
</pre><p>takes a bunch of <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s containg <code>rs</code> and uses them to (purely) produce
 a <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> containing an <code>a</code>.</p><p>If you are exclusively doing implicit backpropagation by combining
 <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s and using <code><a href="Numeric-Backprop.html#t:BPOpI">BPOpI</a></code>s, you are probably better off just importing
 <a href="Numeric-Backprop-Implicit.html">Numeric.Backprop.Implicit</a>, which provides better tools.  This type
 synonym exists in <a href="Numeric-Backprop.html">Numeric.Backprop</a> just for the <code><a href="Numeric-Backprop.html#v:implicitly">implicitly</a></code> function,
 which can convert &quot;implicit&quot; backprop functions like a <code><code><a href="Numeric-Backprop.html#t:BPOpI">BPOpI</a></code> s rs a</code>
 into an &quot;explicit&quot; graph backprop function, a <code><code><a href="Numeric-Backprop.html#t:BPOp">BPOp</a></code> s rs a</code>.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:BVar" class="def">BVar</a> :: <a href="../base-4.9.1.0/Data-Kind.html#t:Type">Type</a> -&gt; [<a href="../base-4.9.1.0/Data-Kind.html#t:Type">Type</a>] -&gt; <a href="../base-4.9.1.0/Data-Kind.html#t:Type">Type</a> -&gt; <a href="../base-4.9.1.0/Data-Kind.html#t:Type">Type</a> <a href="src/Numeric.Backprop.Internal.html#BVar" class="link">Source</a> <a href="#t:BVar" class="selflink">#</a></p><div class="doc"><p>The basic unit of manipulation inside <code><a href="Numeric-Backprop.html#t:BP">BP</a></code>.  Instead of directly
 working with values, you work with <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s contating those values.  When
 you work with a <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>, the <em>backprop</em> library can keep track of what
 values refer to which other values, and so can perform backpropagation
 to compute gradients.</p><p>A <code><code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> s rs a</code> refers to a value of type <code>a</code>, with an environment
 of values of the types <code>rs</code>.  The phantom parameter <code>s</code> is used to
 ensure that stray <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s don't leak outside of the backprop process.</p><p>(That is, if you're using implicit backprop, it ensures that you interact
 with <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s in a polymorphic way.  And, if you're using implicit
 backprop, it ensures that a <code><code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> s rs a</code> never leaves the <code><code><a href="Numeric-Backprop.html#t:BP">BP</a></code> s rs</code>
 that it was created in.)</p><p><code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s have <code><a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a></code>, <code><a href="../base-4.9.1.0/Prelude.html#t:Fractional">Fractional</a></code>, <code><a href="../base-4.9.1.0/Numeric.html#t:Floating">Floating</a></code>, etc. instances, so they
 can be manipulated using polymorphic functions and numeric functions in
 Haskell.  You can add them, subtract them, etc., in &quot;implicit&quot; backprop
 style.</p><p>(However, note that if you directly manipulate <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s using those
 instances or using <code>liftR</code>, it delays evaluation, so every usage site
 has to re-compute the result/create a new node.  If you want to re-use
 a <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> you created using '(+)' or '(-)' or <code>liftR</code>, use <code>bindRef</code> to
 force it first.)</p></div><div class="subs instances"><p id="control.i:BVar" class="caption collapser" onclick="toggleSection('i:BVar')">Instances</p><div id="section.i:BVar" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:BVar:Floating:1" class="instance expander" onclick="toggleSection('i:id:BVar:Floating:1')"></span> <a href="../base-4.9.1.0/Numeric.html#t:Floating">Floating</a> a =&gt; <a href="../base-4.9.1.0/Numeric.html#t:Floating">Floating</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a)</span> <a href="src/Numeric.Backprop.Internal.html#line-269" class="link">Source</a> <a href="#t:BVar" class="selflink">#</a></td><td class="doc"><p>See note for <code><a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a></code> instance.</p></td></tr><tr><td colspan="2"><div id="section.i:id:BVar:Floating:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:pi">pi</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:pi" class="selflink">#</a></p><p class="src"><a href="#v:exp">exp</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:exp" class="selflink">#</a></p><p class="src"><a href="#v:log">log</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:log" class="selflink">#</a></p><p class="src"><a href="#v:sqrt">sqrt</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:sqrt" class="selflink">#</a></p><p class="src"><a href="#v:-42--42-">(**)</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:-42--42-" class="selflink">#</a></p><p class="src"><a href="#v:logBase">logBase</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:logBase" class="selflink">#</a></p><p class="src"><a href="#v:sin">sin</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:sin" class="selflink">#</a></p><p class="src"><a href="#v:cos">cos</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:cos" class="selflink">#</a></p><p class="src"><a href="#v:tan">tan</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:tan" class="selflink">#</a></p><p class="src"><a href="#v:asin">asin</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:asin" class="selflink">#</a></p><p class="src"><a href="#v:acos">acos</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:acos" class="selflink">#</a></p><p class="src"><a href="#v:atan">atan</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:atan" class="selflink">#</a></p><p class="src"><a href="#v:sinh">sinh</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:sinh" class="selflink">#</a></p><p class="src"><a href="#v:cosh">cosh</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:cosh" class="selflink">#</a></p><p class="src"><a href="#v:tanh">tanh</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:tanh" class="selflink">#</a></p><p class="src"><a href="#v:asinh">asinh</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:asinh" class="selflink">#</a></p><p class="src"><a href="#v:acosh">acosh</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:acosh" class="selflink">#</a></p><p class="src"><a href="#v:atanh">atanh</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:atanh" class="selflink">#</a></p><p class="src"><a href="#v:log1p">log1p</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:log1p" class="selflink">#</a></p><p class="src"><a href="#v:expm1">expm1</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:expm1" class="selflink">#</a></p><p class="src"><a href="#v:log1pexp">log1pexp</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:log1pexp" class="selflink">#</a></p><p class="src"><a href="#v:log1mexp">log1mexp</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:log1mexp" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:BVar:Fractional:2" class="instance expander" onclick="toggleSection('i:id:BVar:Fractional:2')"></span> <a href="../base-4.9.1.0/Prelude.html#t:Fractional">Fractional</a> a =&gt; <a href="../base-4.9.1.0/Prelude.html#t:Fractional">Fractional</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a)</span> <a href="src/Numeric.Backprop.Internal.html#line-263" class="link">Source</a> <a href="#t:BVar" class="selflink">#</a></td><td class="doc"><p>See note for <code><a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a></code> instance.</p></td></tr><tr><td colspan="2"><div id="section.i:id:BVar:Fractional:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-47-">(/)</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:-47-" class="selflink">#</a></p><p class="src"><a href="#v:recip">recip</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:recip" class="selflink">#</a></p><p class="src"><a href="#v:fromRational">fromRational</a> :: <a href="../base-4.9.1.0/Prelude.html#t:Rational">Rational</a> -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:fromRational" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:BVar:Num:3" class="instance expander" onclick="toggleSection('i:id:BVar:Num:3')"></span> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a =&gt; <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a)</span> <a href="src/Numeric.Backprop.Internal.html#line-253" class="link">Source</a> <a href="#t:BVar" class="selflink">#</a></td><td class="doc"><p>Note that if you use the <code><a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a></code> instance to create <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s, the
 resulting <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> is deferred/delayed.  At every location you use it, it
 will be recomputed, and a separate graph node will be created.  If you
 are using a <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> you made with the <code><a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a></code> instance in multiple
 locations, use <code>bindRef</code> first to force it and prevent recomputation.</p></td></tr><tr><td colspan="2"><div id="section.i:id:BVar:Num:3" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-43-">(+)</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:-43-" class="selflink">#</a></p><p class="src"><a href="#v:-45-">(-)</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:-45-" class="selflink">#</a></p><p class="src"><a href="#v:-42-">(*)</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:-42-" class="selflink">#</a></p><p class="src"><a href="#v:negate">negate</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:negate" class="selflink">#</a></p><p class="src"><a href="#v:abs">abs</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:abs" class="selflink">#</a></p><p class="src"><a href="#v:signum">signum</a> :: <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:signum" class="selflink">#</a></p><p class="src"><a href="#v:fromInteger">fromInteger</a> :: <a href="../base-4.9.1.0/Prelude.html#t:Integer">Integer</a> -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="#v:fromInteger" class="selflink">#</a></p></div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Op" class="def">Op</a> as a = <span class="keyword">forall</span> m. <a href="../base-4.9.1.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Numeric-Backprop-Op.html#t:OpM">OpM</a> m as a <a href="src/Numeric.Backprop.Op.html#Op" class="link">Source</a> <a href="#t:Op" class="selflink">#</a></p><div class="doc"><p>An <code><code><a href="Numeric-Backprop.html#t:Op">Op</a></code> as a</code> is a type synonym over <code><a href="Numeric-Backprop-Op.html#t:OpM">OpM</a></code> that describes
 a differentiable function from <code>as</code> to <code>a</code>.</p><p>For example, an</p><pre><code><a href="Numeric-Backprop.html#t:Op">Op</a></code> '[Int, Bool] Double
</pre><p>is a function from an <code><a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></code> and a <code><a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></code>, returning a <code><a href="../base-4.9.1.0/Prelude.html#t:Double">Double</a></code>.  It can
 be differentiated to give a <em>gradient</em> of an <code><a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></code> and a <code><a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></code> if given
 a total derivative for <code>a</code>.</p><p>See <code><a href="Numeric-Backprop-Op.html#v:runOp">runOp</a></code>, <code><a href="Numeric-Backprop-Op.html#v:gradOp">gradOp</a></code>, and <code><a href="Numeric-Backprop-Op.html#v:gradOpWith">gradOpWith</a></code> for examples on how to run it,
 and <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> for instructions on creating it.</p><p>This type is abstracted over using the pattern synonym with constructor
 <code><a href="Numeric-Backprop.html#t:Op">Op</a></code>, so you can create one from scratch with it.  However, it's
 simplest to create it using <code><a href="Numeric-Backprop.html#v:op2-39-">op2'</a></code>, <code><a href="Numeric-Backprop.html#v:op1-39-">op1'</a></code>, <code><a href="Numeric-Backprop.html#v:op2-39-">op2'</a></code>, and <code><a href="Numeric-Backprop.html#v:op3-39-">op3'</a></code> helper
 smart constructors  And, if your function is a numeric function, they
 can even be created automatically using <code><a href="Numeric-Backprop.html#v:op1">op1</a></code>, <code><a href="Numeric-Backprop.html#v:op2">op2</a></code>, <code><a href="Numeric-Backprop.html#v:op3">op3</a></code>, and <code><a href="Numeric-Backprop.html#v:opN">opN</a></code>
 with a little help from <a href="../ad-4.3.2.1/Numeric-AD.html">Numeric.AD</a> from the <em>ad</em> library.</p><p>Note that this type is a <em>subset</em> or <em>subtype</em> of <code><a href="Numeric-Backprop-Op.html#t:OpM">OpM</a></code>.  So, if a function
 ever expects an <code><code><a href="Numeric-Backprop-Op.html#t:OpM">OpM</a></code> m as a</code>, you can always provide an <code><code><a href="Numeric-Backprop.html#t:Op">Op</a></code> as a</code>
 instead.</p><p>Many functions in this library will expect an <code><code><a href="Numeric-Backprop-Op.html#t:OpM">OpM</a></code> m as a</code> (or
 an <code><code><a href="Numeric-Backprop.html#v:OpB">OpB</a></code> s as a</code>), and in all of these cases, you can
 provide an <code><code><a href="Numeric-Backprop.html#t:Op">Op</a></code> as a</code>.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:OpB" class="def">OpB</a> s as a = <a href="Numeric-Backprop-Op.html#t:OpM">OpM</a> (<a href="../base-4.9.1.0/Control-Monad-ST.html#t:ST">ST</a> s) as a <a href="src/Numeric.Backprop.Internal.html#OpB" class="link">Source</a> <a href="#t:OpB" class="selflink">#</a></p><div class="doc"><p>A type synonym for <code><a href="Numeric-Backprop-Op.html#t:OpM">OpM</a></code> specialized to what the <em>backprop</em> library
 uses to perform backpropagation.</p><p>An</p><pre><code><a href="Numeric-Backprop.html#t:OpB">OpB</a></code> s rs a
</pre><p>represents a differentiable function that takes a tuple of <code>rs</code> and
 produces an a <code>a</code>, which can be run on <code><code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> s</code> and also inside <code><code><a href="Numeric-Backprop.html#t:BP">BP</a></code>
 s</code>s.  For example, an <code><code><a href="Numeric-Backprop.html#t:OpB">OpB</a></code> s '[ Int, Double ] Bool</code> takes an <code><a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></code> and
 a <code><a href="../base-4.9.1.0/Prelude.html#t:Double">Double</a></code> and produces a <code><a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></code>, and does it in a differentiable way.</p><p>Note that <code><a href="Numeric-Backprop.html#t:OpB">OpB</a></code> is a <em>superset</em> of <code><a href="Numeric-Backprop.html#t:Op">Op</a></code>, so, if you see any function
 that expects an <code><a href="Numeric-Backprop.html#t:OpB">OpB</a></code> (like <code><a href="Numeric-Backprop.html#v:opRef-39-">opRef'</a></code> and
 <code><a href="Numeric-Backprop.html#v:-126--36-">~$</a></code>, for example), you can give them an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code>, as well.</p><p>You can think of <code><a href="Numeric-Backprop.html#t:OpB">OpB</a></code> as a superclass/parent class of <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> in this
 sense, and of <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> as a subclass of <code><a href="Numeric-Backprop.html#t:OpB">OpB</a></code>.</p></div></div><h2 id="g:3">Utility types</h2><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Prod" class="def">Prod</a> k f a :: <span class="keyword">forall</span> k. (k -&gt; <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a>) -&gt; [k] -&gt; <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> <span class="keyword">where</span> <a href="#t:Prod" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:-216-" class="def">&#216;</a> :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f ([] k)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v::-60-" class="def">(:&lt;)</a> :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f ((:) k a1 as) <span class="fixity">infixr 5</span><span class="rightedge"></span></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:Prod" class="caption collapser" onclick="toggleSection('i:Prod')">Instances</p><div id="section.i:Prod" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Prod:Witness:1" class="instance expander" onclick="toggleSection('i:id:Prod:Witness:1')"></span> <a href="../type-combinators-0.2.4.3/Type-Class-Witness.html#t:Witness">Witness</a> <a href="../type-combinators-0.2.4.3/Type-Family-Constraint.html#t:-216-C">&#216;C</a> <a href="../type-combinators-0.2.4.3/Type-Family-Constraint.html#t:-216-C">&#216;C</a> (<a href="Numeric-Backprop.html#t:Prod">Prod</a> k f (<a href="../type-combinators-0.2.4.3/Type-Family-List.html#t:-216-">&#216;</a> k))</span></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Prod:Witness:1" class="inst-details hide"><div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="../type-combinators-0.2.4.3/Type-Class-Witness.html#t:WitnessC">WitnessC</a> (<a href="../type-combinators-0.2.4.3/Type-Family-Constraint.html#t:-216-C">&#216;C</a> :: <a href="../base-4.9.1.0/Data-Kind.html#t:Constraint">Constraint</a>) (<a href="../type-combinators-0.2.4.3/Type-Family-Constraint.html#t:-216-C">&#216;C</a> :: <a href="../base-4.9.1.0/Data-Kind.html#t:Constraint">Constraint</a>) (<a href="Numeric-Backprop.html#t:Prod">Prod</a> k f (<a href="../type-combinators-0.2.4.3/Type-Family-List.html#t:-216-">&#216;</a> k)) :: <a href="../base-4.9.1.0/Data-Kind.html#t:Constraint">Constraint</a> <a href="#t:WitnessC" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-92--92-">(\\)</a> :: <a href="../type-combinators-0.2.4.3/Type-Family-Constraint.html#t:-216-C">&#216;C</a> =&gt; (<a href="../type-combinators-0.2.4.3/Type-Family-Constraint.html#t:-216-C">&#216;C</a> -&gt; r) -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f (<a href="../type-combinators-0.2.4.3/Type-Family-List.html#t:-216-">&#216;</a> k) -&gt; r <a href="#v:-92--92-" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Prod:IxFunctor1:2" class="instance expander" onclick="toggleSection('i:id:Prod:IxFunctor1:2')"></span> <a href="../type-combinators-0.2.4.3/Type-Class-Higher.html#t:IxFunctor1">IxFunctor1</a> k [k] (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Index">Index</a> k) (<a href="Numeric-Backprop.html#t:Prod">Prod</a> k)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Prod:IxFunctor1:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:imap1">imap1</a> :: (<span class="keyword">forall</span> a. i b a -&gt; f a -&gt; g a) -&gt; t f b -&gt; t g b <a href="#v:imap1" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Prod:IxFoldable1:3" class="instance expander" onclick="toggleSection('i:id:Prod:IxFoldable1:3')"></span> <a href="../type-combinators-0.2.4.3/Type-Class-Higher.html#t:IxFoldable1">IxFoldable1</a> k [k] (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Index">Index</a> k) (<a href="Numeric-Backprop.html#t:Prod">Prod</a> k)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Prod:IxFoldable1:3" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:ifoldMap1">ifoldMap1</a> :: <a href="../base-4.9.1.0/Data-Monoid.html#t:Monoid">Monoid</a> m =&gt; (<span class="keyword">forall</span> a. i b a -&gt; f a -&gt; m) -&gt; t f b -&gt; m <a href="#v:ifoldMap1" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Prod:IxTraversable1:4" class="instance expander" onclick="toggleSection('i:id:Prod:IxTraversable1:4')"></span> <a href="../type-combinators-0.2.4.3/Type-Class-Higher.html#t:IxTraversable1">IxTraversable1</a> k [k] (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Index">Index</a> k) (<a href="Numeric-Backprop.html#t:Prod">Prod</a> k)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Prod:IxTraversable1:4" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:itraverse1">itraverse1</a> :: <a href="../base-4.9.1.0/Control-Applicative.html#t:Applicative">Applicative</a> h =&gt; (<span class="keyword">forall</span> a. i b a -&gt; f a -&gt; h (g a)) -&gt; t f b -&gt; h (t g b) <a href="#v:itraverse1" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Prod:Functor1:5" class="instance expander" onclick="toggleSection('i:id:Prod:Functor1:5')"></span> <a href="../type-combinators-0.2.4.3/Type-Class-Higher.html#t:Functor1">Functor1</a> [k] k (<a href="Numeric-Backprop.html#t:Prod">Prod</a> k)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Prod:Functor1:5" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:map1">map1</a> :: (<span class="keyword">forall</span> a. f a -&gt; g a) -&gt; t f b -&gt; t g b <a href="#v:map1" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Prod:Foldable1:6" class="instance expander" onclick="toggleSection('i:id:Prod:Foldable1:6')"></span> <a href="../type-combinators-0.2.4.3/Type-Class-Higher.html#t:Foldable1">Foldable1</a> [k] k (<a href="Numeric-Backprop.html#t:Prod">Prod</a> k)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Prod:Foldable1:6" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:foldMap1">foldMap1</a> :: <a href="../base-4.9.1.0/Data-Monoid.html#t:Monoid">Monoid</a> m =&gt; (<span class="keyword">forall</span> a. f a -&gt; m) -&gt; t f b -&gt; m <a href="#v:foldMap1" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Prod:Traversable1:7" class="instance expander" onclick="toggleSection('i:id:Prod:Traversable1:7')"></span> <a href="../type-combinators-0.2.4.3/Type-Class-Higher.html#t:Traversable1">Traversable1</a> [k] k (<a href="Numeric-Backprop.html#t:Prod">Prod</a> k)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Prod:Traversable1:7" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:traverse1">traverse1</a> :: <a href="../base-4.9.1.0/Control-Applicative.html#t:Applicative">Applicative</a> h =&gt; (<span class="keyword">forall</span> a. f a -&gt; h (g a)) -&gt; t f b -&gt; h (t g b) <a href="#v:traverse1" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Prod:TestEquality:8" class="instance expander" onclick="toggleSection('i:id:Prod:TestEquality:8')"></span> <a href="../base-4.9.1.0/Data-Type-Equality.html#t:TestEquality">TestEquality</a> k f =&gt; <a href="../base-4.9.1.0/Data-Type-Equality.html#t:TestEquality">TestEquality</a> [k] (<a href="Numeric-Backprop.html#t:Prod">Prod</a> k f)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Prod:TestEquality:8" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:testEquality">testEquality</a> :: f a -&gt; f b -&gt; <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> ((<a href="Numeric-Backprop.html#t:Prod">Prod</a> k f <a href="../base-4.9.1.0/Data-Type-Equality.html#t::-126-:">:~:</a> a) b) <a href="#v:testEquality" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Prod:BoolEquality:9" class="instance expander" onclick="toggleSection('i:id:Prod:BoolEquality:9')"></span> <a href="../type-combinators-0.2.4.3/Data-Type-Boolean.html#t:BoolEquality">BoolEquality</a> k f =&gt; <a href="../type-combinators-0.2.4.3/Data-Type-Boolean.html#t:BoolEquality">BoolEquality</a> [k] (<a href="Numeric-Backprop.html#t:Prod">Prod</a> k f)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Prod:BoolEquality:9" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:boolEquality">boolEquality</a> :: f a -&gt; f b -&gt; <a href="../type-combinators-0.2.4.3/Data-Type-Boolean.html#t:Boolean">Boolean</a> ((<a href="Numeric-Backprop.html#t:Prod">Prod</a> k f <a href="../base-4.9.1.0/Data-Type-Equality.html#t:-61--61-">==</a> a) b) <a href="#v:boolEquality" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Prod:Eq1:10" class="instance expander" onclick="toggleSection('i:id:Prod:Eq1:10')"></span> <a href="../type-combinators-0.2.4.3/Type-Class-Higher.html#t:Eq1">Eq1</a> k f =&gt; <a href="../type-combinators-0.2.4.3/Type-Class-Higher.html#t:Eq1">Eq1</a> [k] (<a href="Numeric-Backprop.html#t:Prod">Prod</a> k f)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Prod:Eq1:10" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:eq1">eq1</a> :: f a -&gt; f a -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:eq1" class="selflink">#</a></p><p class="src"><a href="#v:neq1">neq1</a> :: f a -&gt; f a -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:neq1" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Prod:Ord1:11" class="instance expander" onclick="toggleSection('i:id:Prod:Ord1:11')"></span> <a href="../type-combinators-0.2.4.3/Type-Class-Higher.html#t:Ord1">Ord1</a> k f =&gt; <a href="../type-combinators-0.2.4.3/Type-Class-Higher.html#t:Ord1">Ord1</a> [k] (<a href="Numeric-Backprop.html#t:Prod">Prod</a> k f)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Prod:Ord1:11" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:compare1">compare1</a> :: f a -&gt; f a -&gt; <a href="../base-4.9.1.0/Data-Ord.html#t:Ordering">Ordering</a> <a href="#v:compare1" class="selflink">#</a></p><p class="src"><a href="#v:-60--35-">(&lt;#)</a> :: f a -&gt; f a -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-60--35-" class="selflink">#</a></p><p class="src"><a href="#v:-62--35-">(&gt;#)</a> :: f a -&gt; f a -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-62--35-" class="selflink">#</a></p><p class="src"><a href="#v:-60--61--35-">(&lt;=#)</a> :: f a -&gt; f a -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-60--61--35-" class="selflink">#</a></p><p class="src"><a href="#v:-62--61--35-">(&gt;=#)</a> :: f a -&gt; f a -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-62--61--35-" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Prod:Show1:12" class="instance expander" onclick="toggleSection('i:id:Prod:Show1:12')"></span> <a href="../type-combinators-0.2.4.3/Type-Class-Higher.html#t:Show1">Show1</a> k f =&gt; <a href="../type-combinators-0.2.4.3/Type-Class-Higher.html#t:Show1">Show1</a> [k] (<a href="Numeric-Backprop.html#t:Prod">Prod</a> k f)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Prod:Show1:12" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec1">showsPrec1</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; f a -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec1" class="selflink">#</a></p><p class="src"><a href="#v:show1">show1</a> :: f a -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="#v:show1" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Prod:Read1:13" class="instance expander" onclick="toggleSection('i:id:Prod:Read1:13')"></span> <a href="../type-combinators-0.2.4.3/Type-Class-Higher.html#t:Read1">Read1</a> k f =&gt; <a href="../type-combinators-0.2.4.3/Type-Class-Higher.html#t:Read1">Read1</a> [k] (<a href="Numeric-Backprop.html#t:Prod">Prod</a> k f)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Prod:Read1:13" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:readsPrec1">readsPrec1</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="../base-4.9.1.0/Text-ParserCombinators-ReadP.html#t:ReadS">ReadS</a> (<a href="../type-combinators-0.2.4.3/Type-Class-Higher.html#t:Some">Some</a> (<a href="Numeric-Backprop.html#t:Prod">Prod</a> k f) f) <a href="#v:readsPrec1" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Prod:Known:14" class="instance expander" onclick="toggleSection('i:id:Prod:Known:14')"></span> (<a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> [k] (<a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> k) as, <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> k (<a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> k f) as) =&gt; <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> [k] (<a href="Numeric-Backprop.html#t:Prod">Prod</a> k f) as</span></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Prod:Known:14" class="inst-details hide"><div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:KnownC">KnownC</a> (<a href="Numeric-Backprop.html#t:Prod">Prod</a> k f) (as :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f -&gt; <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a>) (a :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f) :: <a href="../base-4.9.1.0/Data-Kind.html#t:Constraint">Constraint</a> <a href="#t:KnownC" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:known">known</a> :: as a <a href="#v:known" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Prod:Witness:15" class="instance expander" onclick="toggleSection('i:id:Prod:Witness:15')"></span> (<a href="../type-combinators-0.2.4.3/Type-Class-Witness.html#t:Witness">Witness</a> p q (f a1), <a href="../type-combinators-0.2.4.3/Type-Class-Witness.html#t:Witness">Witness</a> s t (<a href="Numeric-Backprop.html#t:Prod">Prod</a> a f as)) =&gt; <a href="../type-combinators-0.2.4.3/Type-Class-Witness.html#t:Witness">Witness</a> (p, s) (q, t) (<a href="Numeric-Backprop.html#t:Prod">Prod</a> a f (<a href="../type-combinators-0.2.4.3/Type-Family-List.html#t::-60-">(:&lt;)</a> a a1 as))</span></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Prod:Witness:15" class="inst-details hide"><div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="../type-combinators-0.2.4.3/Type-Class-Witness.html#t:WitnessC">WitnessC</a> ((p, s) :: <a href="../base-4.9.1.0/Data-Kind.html#t:Constraint">Constraint</a>) ((q, t) :: <a href="../base-4.9.1.0/Data-Kind.html#t:Constraint">Constraint</a>) (<a href="Numeric-Backprop.html#t:Prod">Prod</a> a f (<a href="../type-combinators-0.2.4.3/Type-Family-List.html#t::-60-">(:&lt;)</a> a a1 as)) :: <a href="../base-4.9.1.0/Data-Kind.html#t:Constraint">Constraint</a> <a href="#t:WitnessC" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-92--92-">(\\)</a> :: (p, s) =&gt; ((q, t) -&gt; r) -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> a f ((a <a href="../type-combinators-0.2.4.3/Type-Family-List.html#t::-60-">:&lt;</a> a1) as) -&gt; r <a href="#v:-92--92-" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Prod:Eq:16" class="instance expander" onclick="toggleSection('i:id:Prod:Eq:16')"></span> <a href="../type-combinators-0.2.4.3/Type-Family-List.html#t:ListC">ListC</a> (<a href="../type-combinators-0.2.4.3/Type-Family-List.html#t:-60--36--62-">(&lt;$&gt;)</a> <a href="../base-4.9.1.0/Data-Kind.html#t:Constraint">Constraint</a> <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> <a href="../base-4.9.1.0/Data-Eq.html#t:Eq">Eq</a> (<a href="../type-combinators-0.2.4.3/Type-Family-List.html#t:-60--36--62-">(&lt;$&gt;)</a> <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> k f as)) =&gt; <a href="../base-4.9.1.0/Data-Eq.html#t:Eq">Eq</a> (<a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Prod:Eq:16" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Prod:Ord:17" class="instance expander" onclick="toggleSection('i:id:Prod:Ord:17')"></span> (<a href="../type-combinators-0.2.4.3/Type-Family-List.html#t:ListC">ListC</a> (<a href="../type-combinators-0.2.4.3/Type-Family-List.html#t:-60--36--62-">(&lt;$&gt;)</a> <a href="../base-4.9.1.0/Data-Kind.html#t:Constraint">Constraint</a> <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> <a href="../base-4.9.1.0/Data-Eq.html#t:Eq">Eq</a> (<a href="../type-combinators-0.2.4.3/Type-Family-List.html#t:-60--36--62-">(&lt;$&gt;)</a> <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> k f as)), <a href="../type-combinators-0.2.4.3/Type-Family-List.html#t:ListC">ListC</a> (<a href="../type-combinators-0.2.4.3/Type-Family-List.html#t:-60--36--62-">(&lt;$&gt;)</a> <a href="../base-4.9.1.0/Data-Kind.html#t:Constraint">Constraint</a> <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> <a href="../base-4.9.1.0/Data-Ord.html#t:Ord">Ord</a> (<a href="../type-combinators-0.2.4.3/Type-Family-List.html#t:-60--36--62-">(&lt;$&gt;)</a> <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> k f as))) =&gt; <a href="../base-4.9.1.0/Data-Ord.html#t:Ord">Ord</a> (<a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Prod:Ord:17" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:compare">compare</a> :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as -&gt; <a href="../base-4.9.1.0/Data-Ord.html#t:Ordering">Ordering</a> <a href="#v:compare" class="selflink">#</a></p><p class="src"><a href="#v:-60-">(&lt;)</a> :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-60-" class="selflink">#</a></p><p class="src"><a href="#v:-60--61-">(&lt;=)</a> :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-60--61-" class="selflink">#</a></p><p class="src"><a href="#v:-62-">(&gt;)</a> :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-62-" class="selflink">#</a></p><p class="src"><a href="#v:-62--61-">(&gt;=)</a> :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="#v:-62--61-" class="selflink">#</a></p><p class="src"><a href="#v:max">max</a> :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as <a href="#v:max" class="selflink">#</a></p><p class="src"><a href="#v:min">min</a> :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as <a href="#v:min" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Prod:Show:18" class="instance expander" onclick="toggleSection('i:id:Prod:Show:18')"></span> <a href="../type-combinators-0.2.4.3/Type-Family-List.html#t:ListC">ListC</a> (<a href="../type-combinators-0.2.4.3/Type-Family-List.html#t:-60--36--62-">(&lt;$&gt;)</a> <a href="../base-4.9.1.0/Data-Kind.html#t:Constraint">Constraint</a> <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> (<a href="../type-combinators-0.2.4.3/Type-Family-List.html#t:-60--36--62-">(&lt;$&gt;)</a> <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> k f as)) =&gt; <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> (<a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as)</span></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Prod:Show:18" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Numeric-Backprop.html#t:Prod">Prod</a> k f as] -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Prod:WitnessC:19" class="instance expander" onclick="toggleSection('i:id:Prod:WitnessC:19')"></span> <span class="keyword">type</span> <a href="../type-combinators-0.2.4.3/Type-Class-Witness.html#t:WitnessC">WitnessC</a> <a href="../type-combinators-0.2.4.3/Type-Family-Constraint.html#t:-216-C">&#216;C</a> <a href="../type-combinators-0.2.4.3/Type-Family-Constraint.html#t:-216-C">&#216;C</a> (<a href="Numeric-Backprop.html#t:Prod">Prod</a> k f (<a href="../type-combinators-0.2.4.3/Type-Family-List.html#t:-216-">&#216;</a> k))</span></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Prod:WitnessC:19" class="inst-details hide"><div class="src"><span class="keyword">type</span> <a href="../type-combinators-0.2.4.3/Type-Class-Witness.html#t:WitnessC">WitnessC</a> <a href="../type-combinators-0.2.4.3/Type-Family-Constraint.html#t:-216-C">&#216;C</a> <a href="../type-combinators-0.2.4.3/Type-Family-Constraint.html#t:-216-C">&#216;C</a> (<a href="Numeric-Backprop.html#t:Prod">Prod</a> k f (<a href="../type-combinators-0.2.4.3/Type-Family-List.html#t:-216-">&#216;</a> k)) = <a href="../type-combinators-0.2.4.3/Type-Family-Constraint.html#t:-216-C">&#216;C</a></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Prod:KnownC:20" class="instance expander" onclick="toggleSection('i:id:Prod:KnownC:20')"></span> <span class="keyword">type</span> <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:KnownC">KnownC</a> [k] (<a href="Numeric-Backprop.html#t:Prod">Prod</a> k f) as</span></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Prod:KnownC:20" class="inst-details hide"><div class="src"><span class="keyword">type</span> <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:KnownC">KnownC</a> [k] (<a href="Numeric-Backprop.html#t:Prod">Prod</a> k f) as = (<a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> [k] (<a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> k) as, <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> k (<a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> k f) as)</div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Prod:WitnessC:21" class="instance expander" onclick="toggleSection('i:id:Prod:WitnessC:21')"></span> <span class="keyword">type</span> <a href="../type-combinators-0.2.4.3/Type-Class-Witness.html#t:WitnessC">WitnessC</a> (p, s) (q, t) (<a href="Numeric-Backprop.html#t:Prod">Prod</a> a f (<a href="../type-combinators-0.2.4.3/Type-Family-List.html#t::-60-">(:&lt;)</a> a a1 as))</span></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Prod:WitnessC:21" class="inst-details hide"><div class="src"><span class="keyword">type</span> <a href="../type-combinators-0.2.4.3/Type-Class-Witness.html#t:WitnessC">WitnessC</a> (p, s) (q, t) (<a href="Numeric-Backprop.html#t:Prod">Prod</a> a f (<a href="../type-combinators-0.2.4.3/Type-Family-List.html#t::-60-">(:&lt;)</a> a a1 as)) = (<a href="../type-combinators-0.2.4.3/Type-Class-Witness.html#t:Witness">Witness</a> p q (f a1), <a href="../type-combinators-0.2.4.3/Type-Class-Witness.html#t:Witness">Witness</a> s t (<a href="Numeric-Backprop.html#t:Prod">Prod</a> a f as))</div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Tuple" class="def">Tuple</a> = <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> <a href="../type-combinators-0.2.4.3/Data-Type-Combinator.html#t:I">I</a> <a href="#t:Tuple" class="selflink">#</a></p><div class="doc"><p>A Prod of simple Haskell types.</p></div></div><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:Summer" class="def">Summer</a> a <a href="src/Numeric.Backprop.Internal.Helper.html#Summer" class="link">Source</a> <a href="#t:Summer" class="selflink">#</a></p><div class="doc"><p>Instructions on how to &quot;sum&quot; a list of values of a given type.
 Basically used as an explicit witness for a <code><a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a></code> instance.</p><p>For most types, the only meaningful value of type <code><code><a href="Numeric-Backprop.html#t:Summer">Summer</a></code> a</code> is
 <code><code><a href="Numeric-Backprop.html#t:Summer">Summer</a></code> <code><a href="../base-4.9.1.0/Data-Foldable.html#v:sum">sum</a></code></code>.  However, using <code><a href="Numeric-Backprop.html#t:Summer">Summer</a></code> lets us use <code>BP</code> with types
 that are <em>not</em> instances of <code><a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a></code>.  Any type can be used, as long as you
 provide a way to &quot;sum&quot; it!</p><p>For most of the functions in this library, you can completely ignore
 this, as they will be generated automatically.  You only need to work
 with this directly if you want to use custom types that <em>aren't</em>
 instances of <code><a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a></code> with this library.</p><p>If 'Num a' is satisfied, one can create the canonical <code><a href="Numeric-Backprop.html#t:Summer">Summer</a></code> using
 <code><code><a href="../type-combinators-0.2.4.3/Type-Class-Known.html#v:known">known</a></code> :: <code><a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a></code> a =&gt; <code><a href="Numeric-Backprop.html#t:Summer">Summer</a></code> a</code>.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Summer" class="def">Summer</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:runSummer" class="def">runSummer</a> :: [a] -&gt; a</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:Summer" class="caption collapser" onclick="toggleSection('i:Summer')">Instances</p><div id="section.i:Summer" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Summer:Known:1" class="instance expander" onclick="toggleSection('i:id:Summer:Known:1')"></span> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a =&gt; <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> a</span> <a href="src/Numeric.Backprop.Internal.Helper.html#line-71" class="link">Source</a> <a href="#t:Summer" class="selflink">#</a></td><td class="doc"><p>If <code>a</code> is an instance of <code><a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a></code>, then the canonical <code><code><a href="Numeric-Backprop.html#t:Summer">Summer</a></code> a</code> is
 <code><code><a href="Numeric-Backprop.html#t:Summer">Summer</a></code> <code><a href="../base-4.9.1.0/Data-Foldable.html#v:sum">sum</a></code></code>.</p></td></tr><tr><td colspan="2"><div id="section.i:id:Summer:Known:1" class="inst-details hide"><div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:KnownC">KnownC</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> (a :: <a href="Numeric-Backprop.html#t:Summer">Summer</a> -&gt; <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a>) (a :: <a href="Numeric-Backprop.html#t:Summer">Summer</a>) :: <a href="../base-4.9.1.0/Data-Kind.html#t:Constraint">Constraint</a> <a href="#t:KnownC" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:known">known</a> :: a a <a href="#v:known" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Summer:KnownC:2" class="instance expander" onclick="toggleSection('i:id:Summer:KnownC:2')"></span> <span class="keyword">type</span> <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:KnownC">KnownC</a> <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> a</span> <a href="src/Numeric.Backprop.Internal.Helper.html#line-72" class="link">Source</a> <a href="#t:Summer" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Summer:KnownC:2" class="inst-details hide"><div class="src"><span class="keyword">type</span> <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:KnownC">KnownC</a> <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> a = <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a</div></div></td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:Unity" class="def">Unity</a> a <a href="src/Numeric.Backprop.Internal.Helper.html#Unity" class="link">Source</a> <a href="#t:Unity" class="selflink">#</a></p><div class="doc"><p>A canonical &quot;unity&quot; (the multiplicative identity) for a given type.
 Basically used as an explicit witness for a <code><a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a></code> instance.</p><p>For most types, the only meaningful value of type <code><code><a href="Numeric-Backprop.html#t:Unity">Unity</a></code> a</code> is
 <code><code><a href="Numeric-Backprop.html#t:Unity">Unity</a></code> 1'</code>.  However, using <code><a href="Numeric-Backprop.html#t:Unity">Unity</a></code> lets us use <code>BP</code> with types
 that are <em>not</em> instances of <code><a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a></code>.  Any type can be used, as long as you
 provide a way to get a multiplicative identity in it!</p><p>For most of the functions in this library, you can completely ignore
 this, as they will be generated automatically.  You only need to work
 with this directly if you want to use custom types that <em>aren't</em>
 instances of <code><a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a></code> with this library.</p><p>If 'Num a' is satisfied, one can create the canonical <code><a href="Numeric-Backprop.html#t:Unity">Unity</a></code> using
 <code><code><a href="../type-combinators-0.2.4.3/Type-Class-Known.html#v:known">known</a></code> :: <code><a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a></code> a =&gt; <code><a href="Numeric-Backprop.html#t:Unity">Unity</a></code> a</code>.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Unity" class="def">Unity</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:getUnity" class="def">getUnity</a> :: a</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><p id="control.i:Unity" class="caption collapser" onclick="toggleSection('i:Unity')">Instances</p><div id="section.i:Unity" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Unity:Functor:1" class="instance expander" onclick="toggleSection('i:id:Unity:Functor:1')"></span> <a href="../base-4.9.1.0/Data-Functor.html#t:Functor">Functor</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a></span> <a href="src/Numeric.Backprop.Internal.Helper.html#line-67" class="link">Source</a> <a href="#t:Unity" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Unity:Functor:1" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fmap">fmap</a> :: (a -&gt; b) -&gt; <a href="Numeric-Backprop.html#t:Unity">Unity</a> a -&gt; <a href="Numeric-Backprop.html#t:Unity">Unity</a> b <a href="#v:fmap" class="selflink">#</a></p><p class="src"><a href="#v:-60--36-">(&lt;$)</a> :: a -&gt; <a href="Numeric-Backprop.html#t:Unity">Unity</a> b -&gt; <a href="Numeric-Backprop.html#t:Unity">Unity</a> a <a href="#v:-60--36-" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Unity:Show:2" class="instance expander" onclick="toggleSection('i:id:Unity:Show:2')"></span> <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> a =&gt; <a href="../base-4.9.1.0/Text-Show.html#t:Show">Show</a> (<a href="Numeric-Backprop.html#t:Unity">Unity</a> a)</span> <a href="src/Numeric.Backprop.Internal.Helper.html#line-67" class="link">Source</a> <a href="#t:Unity" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Unity:Show:2" class="inst-details hide"><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Numeric-Backprop.html#t:Unity">Unity</a> a -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Numeric-Backprop.html#t:Unity">Unity</a> a -&gt; <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Numeric-Backprop.html#t:Unity">Unity</a> a] -&gt; <a href="../base-4.9.1.0/Text-Show.html#t:ShowS">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Unity:Known:3" class="instance expander" onclick="toggleSection('i:id:Unity:Known:3')"></span> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a =&gt; <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> a</span> <a href="src/Numeric.Backprop.Internal.Helper.html#line-77" class="link">Source</a> <a href="#t:Unity" class="selflink">#</a></td><td class="doc"><p>If <code>a</code> is an instance of <code><a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a></code>, then the canonical <code><code><a href="Numeric-Backprop.html#t:Unity">Unity</a></code> a</code> is
 <code><code><a href="Numeric-Backprop.html#t:Unity">Unity</a></code> 1</code>.</p></td></tr><tr><td colspan="2"><div id="section.i:id:Unity:Known:3" class="inst-details hide"><div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:KnownC">KnownC</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> (a :: <a href="Numeric-Backprop.html#t:Unity">Unity</a> -&gt; <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a>) (a :: <a href="Numeric-Backprop.html#t:Unity">Unity</a>) :: <a href="../base-4.9.1.0/Data-Kind.html#t:Constraint">Constraint</a> <a href="#t:KnownC" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:known">known</a> :: a a <a href="#v:known" class="selflink">#</a></p></div></div></td></tr><tr><td class="src clearfix"><span class="inst-left"><span id="control.i:id:Unity:KnownC:4" class="instance expander" onclick="toggleSection('i:id:Unity:KnownC:4')"></span> <span class="keyword">type</span> <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:KnownC">KnownC</a> <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> a</span> <a href="src/Numeric.Backprop.Internal.Helper.html#line-78" class="link">Source</a> <a href="#t:Unity" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div id="section.i:id:Unity:KnownC:4" class="inst-details hide"><div class="src"><span class="keyword">type</span> <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:KnownC">KnownC</a> <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> a = <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a</div></div></td></tr></table></div></div></div><h1 id="g:4">BP</h1><h2 id="g:5">Backprop</h2><div class="top"><p class="src"><a id="v:backprop" class="def">backprop</a> :: <span class="keyword">forall</span> rs a. <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> rs =&gt; (<span class="keyword">forall</span> s. <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s rs a) -&gt; <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> rs -&gt; (a, <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> rs) <a href="src/Numeric.Backprop.html#backprop" class="link">Source</a> <a href="#v:backprop" class="selflink">#</a></p><div class="doc"><p>Perform backpropagation on the given <code><a href="Numeric-Backprop.html#t:BPOp">BPOp</a></code>.  Returns the result of
 the operation it represents, as well as the gradient of the result with
 respect to its inputs.</p></div></div><div class="top"><p class="src"><a id="v:evalBPOp" class="def">evalBPOp</a> <a href="src/Numeric.Backprop.html#evalBPOp" class="link">Source</a> <a href="#v:evalBPOp" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> rs</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (<span class="keyword">forall</span> s. <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s rs a)</td><td class="doc"><p><code><a href="Numeric-Backprop.html#t:BPOp">BPOp</a></code> to run</p></td></tr><tr><td class="src">-&gt; <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> rs</td><td class="doc"><p>input</p></td></tr><tr><td class="src">-&gt; a</td><td class="doc"><p>output</p></td></tr></table></div><div class="doc"><p>Simply run the <code><a href="Numeric-Backprop.html#t:BPOp">BPOp</a></code> on an input tuple, getting the result without
 bothering with the gradient or with backpropagation.</p></div></div><div class="top"><p class="src"><a id="v:gradBPOp" class="def">gradBPOp</a> <a href="src/Numeric.Backprop.html#gradBPOp" class="link">Source</a> <a href="#v:gradBPOp" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> rs</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (<span class="keyword">forall</span> s. <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s rs a)</td><td class="doc"><p><code><a href="Numeric-Backprop.html#t:BPOp">BPOp</a></code> to differentiate</p></td></tr><tr><td class="src">-&gt; <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> rs</td><td class="doc"><p>input</p></td></tr><tr><td class="src">-&gt; <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> rs</td><td class="doc"><p>gradient</p></td></tr></table></div><div class="doc"><p>Run the <code><a href="Numeric-Backprop.html#t:BPOp">BPOp</a></code> on an input tuple and return the gradient of the result
 with respect to the input tuple.</p></div></div><div class="top"><p class="src"><a id="v:backprop-39-" class="def">backprop'</a> :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> rs -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> rs -&gt; (<span class="keyword">forall</span> s. <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s rs a) -&gt; <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> rs -&gt; (a, <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> rs) <a href="src/Numeric.Backprop.html#backprop%27" class="link">Source</a> <a href="#v:backprop-39-" class="selflink">#</a></p><div class="doc"><p>A version of <code><a href="Numeric-Backprop.html#v:backprop">backprop</a></code> taking explicit <code><a href="Numeric-Backprop.html#t:Summer">Summer</a></code>s and <code><a href="Numeric-Backprop.html#t:Unity">Unity</a></code>s, so it
 can be run with types that aren't instances of <code><a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:evalBPOp-39-" class="def">evalBPOp'</a> <a href="src/Numeric.Backprop.html#evalBPOp%27" class="link">Source</a> <a href="#v:evalBPOp-39-" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> rs</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> rs</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; (<span class="keyword">forall</span> s. <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s rs a)</td><td class="doc"><p><code><a href="Numeric-Backprop.html#t:BPOp">BPOp</a></code> to run</p></td></tr><tr><td class="src">-&gt; <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> rs</td><td class="doc"><p>input</p></td></tr><tr><td class="src">-&gt; a</td><td class="doc"><p>output</p></td></tr></table></div><div class="doc"><p>A version of <code><a href="Numeric-Backprop.html#v:evalBPOp">evalBPOp</a></code> taking explicit <code><a href="Numeric-Backprop.html#t:Summer">Summer</a></code>s and <code><a href="Numeric-Backprop.html#t:Unity">Unity</a></code>s, so it
 can be run with types that aren't instances of <code><a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:gradBPOp-39-" class="def">gradBPOp'</a> <a href="src/Numeric.Backprop.html#gradBPOp%27" class="link">Source</a> <a href="#v:gradBPOp-39-" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> rs</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> rs</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; (<span class="keyword">forall</span> s. <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s rs a)</td><td class="doc"><p><code><a href="Numeric-Backprop.html#t:BPOp">BPOp</a></code> to differentiate'</p></td></tr><tr><td class="src">-&gt; <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> rs</td><td class="doc"><p>input</p></td></tr><tr><td class="src">-&gt; <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> rs</td><td class="doc"><p>gradient</p></td></tr></table></div><div class="doc"><p>A version of <code><a href="Numeric-Backprop.html#v:gradBPOp">gradBPOp</a></code> taking explicit <code><a href="Numeric-Backprop.html#t:Summer">Summer</a></code>s and <code><a href="Numeric-Backprop.html#t:Unity">Unity</a></code>s, so it
 can be run with types that aren't instances of <code><a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a></code>.</p></div></div><h2 id="g:6">Utility combinators</h2><div class="top"><p class="src"><a id="v:withInps" class="def">withInps</a> :: <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> rs =&gt; (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) rs -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a) -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a <a href="src/Numeric.Backprop.html#withInps" class="link">Source</a> <a href="#v:withInps" class="selflink">#</a></p><div class="doc"><p>Runs a continuation on a <code><a href="Numeric-Backprop.html#t:Prod">Prod</a></code> of all of the input <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s.</p><p>Handy for bringing the environment into scope and doing stuff with it:</p><pre>foo :: <code><a href="Numeric-Backprop.html#t:BPOp">BPOp</a></code> '[Double, Int] a
foo = <code><a href="Numeric-Backprop.html#v:withInps">withInps</a></code> $ (x :<a href="y">:&lt; &#216;) -</a> do
    -- do stuff with inputs
</pre><p>Looks kinda like <code>foo (x :&lt; y :&lt; &#216;) = -- ...</code>, don't it?</p><p>Note that the above is the same as</p><pre>foo :: <code><a href="Numeric-Backprop.html#t:BPOp">BPOp</a></code> '[Double, Int] a
foo = do
    x :&lt; y :&lt; &#216; &lt;- <code><a href="Numeric-Backprop.html#v:inpRefs">inpRefs</a></code>
    -- do stuff with inputs
</pre><p>But just a little nicer!</p></div></div><div class="top"><p class="src"><a id="v:implicitly" class="def">implicitly</a> :: <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> rs =&gt; <a href="Numeric-Backprop.html#t:BPOpI">BPOpI</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s rs a <a href="src/Numeric.Backprop.html#implicitly" class="link">Source</a> <a href="#v:implicitly" class="selflink">#</a></p><div class="doc"><p>Convert a <code><a href="Numeric-Backprop.html#t:BPOpI">BPOpI</a></code> into a <code><a href="Numeric-Backprop.html#t:BPOp">BPOp</a></code>.  That is, convert a function on
 a bundle of <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s (generating an implicit graph) into a fully fledged
 <code><a href="Numeric-Backprop.html#t:BPOp">BPOp</a></code> that you can run <code><a href="Numeric-Backprop.html#v:backprop">backprop</a></code> on.  See <code><a href="Numeric-Backprop.html#t:BPOpI">BPOpI</a></code> for more
 information.</p><p>If you are going to write exclusively using implicit <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> operations,
 it might be more convenient to use <a href="Numeric-Backprop-Implicit.html">Numeric.Backprop.Implicit</a> instead,
 which is geared around that use case.</p></div></div><div class="top"><p class="src"><a id="v:withInps-39-" class="def">withInps'</a> :: <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> rs -&gt; (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) rs -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a) -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a <a href="src/Numeric.Backprop.html#withInps%27" class="link">Source</a> <a href="#v:withInps-39-" class="selflink">#</a></p><div class="doc"><p>A version of <code><a href="Numeric-Backprop.html#v:withInps">withInps</a></code> taking explicit <code><a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a></code>, indicating the
 number of inputs required and their types.</p><p>Mostly useful for rare &quot;extremely polymorphic&quot; situations.  If you ever
 actually explicitly write down <code>rs</code> as a list of types, you should be
 able to just use <code><a href="Numeric-Backprop.html#v:withInps">withInps</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:implicitly-39-" class="def">implicitly'</a> :: <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> rs -&gt; <a href="Numeric-Backprop.html#t:BPOpI">BPOpI</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s rs a <a href="src/Numeric.Backprop.html#implicitly%27" class="link">Source</a> <a href="#v:implicitly-39-" class="selflink">#</a></p><div class="doc"><p>A version of <code><a href="Numeric-Backprop.html#v:implicitly">implicitly</a></code> taking explicit <code><a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a></code>, indicating the
 number of inputs required and their types.</p><p>Mostly useful for rare &quot;extremely polymorphic&quot; situations.  If you ever
 actually explicitly write down <code>rs</code> as a list of types, you should be
 able to just use <code><a href="Numeric-Backprop.html#v:implicitly">implicitly</a></code>.</p></div></div><h1 id="g:7">Refs</h1><div class="top"><p class="src"><a id="v:constRef" class="def">constRef</a> :: a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="src/Numeric.Backprop.html#constRef" class="link">Source</a> <a href="#v:constRef" class="selflink">#</a></p><div class="doc"><p>Create a <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> that represents just a specific value, that doesn't
 depend on any other <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s.</p></div></div><div class="top"><p class="src"><a id="v:inpRef" class="def">inpRef</a> :: <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Index">Index</a> rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="src/Numeric.Backprop.html#inpRef" class="link">Source</a> <a href="#v:inpRef" class="selflink">#</a></p><div class="doc"><p>Create a <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code> given an index into the input environment.  For an
 example,</p><pre><code><a href="Numeric-Backprop.html#v:inpRef">inpRef</a></code> <code><a href="../type-combinators-0.2.4.3/Data-Type-Index.html#v:IZ">IZ</a></code>
</pre><p>would refer to the <em>first</em> input variable (the <code><a href="../base-4.9.1.0/Data-Int.html#t:Int">Int</a></code> in a
 <code><code><a href="Numeric-Backprop.html#t:BP">BP</a></code> s '[Int, Bool]</code>), and</p><pre><code><a href="Numeric-Backprop.html#v:inpRef">inpRef</a></code> (<code><a href="../type-combinators-0.2.4.3/Data-Type-Index.html#v:IS">IS</a></code> <code><a href="../type-combinators-0.2.4.3/Data-Type-Index.html#v:IZ">IZ</a></code>)
</pre><p>Would refer to the <em>second</em> input variable (the <code><a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></code> in a
 <code><code><a href="Numeric-Backprop.html#t:BP">BP</a></code> s '[Int, Bool]</code>)</p><p>Typically, there shouldn't be any reason to use <code><a href="Numeric-Backprop.html#v:inpRef">inpRef</a></code> directly.  It's
 cleaner to get all of your input <code><a href="Numeric-Backprop.html#t:BVar">BVar</a></code>s together using <code><a href="Numeric-Backprop.html#v:withInps">withInps</a></code> or
 <code><a href="Numeric-Backprop.html#v:inpRefs">inpRefs</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:inpRefs" class="def">inpRefs</a> :: <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> rs =&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) rs <a href="src/Numeric.Backprop.html#inpRefs" class="link">Source</a> <a href="#v:inpRefs" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:bpOp" class="def">bpOp</a> :: (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> as, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> as) =&gt; <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s as a -&gt; <a href="Numeric-Backprop.html#t:OpB">OpB</a> s as a <a href="src/Numeric.Backprop.html#bpOp" class="link">Source</a> <a href="#v:bpOp" class="selflink">#</a></p><div class="doc"><p>Turn a <code><a href="Numeric-Backprop.html#t:BPOp">BPOp</a></code> into an <code><a href="Numeric-Backprop.html#t:OpB">OpB</a></code>.  Basically converts a <code><a href="Numeric-Backprop.html#t:BP">BP</a></code> taking an <code>rs</code>
 and producing an <code>a</code> into an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> taking an <code>rs</code> and returning an <code>a</code>,
 with all of the powers and utility of an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code>, including all of its
 gradient-finding glory.</p><p>Handy because an <code><a href="Numeric-Backprop.html#t:OpB">OpB</a></code> can be used with almost all of
 the <code><a href="Numeric-Backprop.html#t:Op">Op</a></code>-related functions in this moduel, including <code><a href="Numeric-Backprop.html#v:opRef">opRef</a></code>, <code><a href="Numeric-Backprop.html#v:-126--36-">~$</a></code>, etc.</p></div></div><div class="top"><p class="src"><a id="v:bindRef" class="def">bindRef</a> :: <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a) <a href="src/Numeric.Backprop.html#bindRef" class="link">Source</a> <a href="#v:bindRef" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:inpRefs-39-" class="def">inpRefs'</a> :: <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> rs -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) rs <a href="src/Numeric.Backprop.html#inpRefs%27" class="link">Source</a> <a href="#v:inpRefs-39-" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:bpOp-39-" class="def">bpOp'</a> :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> as -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> as -&gt; <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s as a -&gt; <a href="Numeric-Backprop.html#t:OpB">OpB</a> s as a <a href="src/Numeric.Backprop.html#bpOp%27" class="link">Source</a> <a href="#v:bpOp-39-" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:bindRef-39-" class="def">bindRef'</a> :: <a href="Numeric-Backprop.html#t:Summer">Summer</a> a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a) <a href="src/Numeric.Backprop.html#bindRef%27" class="link">Source</a> <a href="#v:bindRef-39-" class="selflink">#</a></p></div><h2 id="g:8">From Ops</h2><div class="top"><p class="src"><a id="v:opRef" class="def">opRef</a> :: <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a =&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) as -&gt; <a href="Numeric-Backprop.html#t:OpB">OpB</a> s as a -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a) <a href="src/Numeric.Backprop.html#opRef" class="link">Source</a> <a href="#v:opRef" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:-126--36-" class="def">(~$)</a> :: <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a =&gt; <a href="Numeric-Backprop.html#t:OpB">OpB</a> s as a -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) as -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a) <span class="fixity">infixr 1</span><span class="rightedge"></span> <a href="src/Numeric.Backprop.html#~%24" class="link">Source</a> <a href="#v:-126--36-" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:opRef1" class="def">opRef1</a> :: <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> b =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:OpB">OpB</a> s '[a] b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b) <a href="src/Numeric.Backprop.html#opRef1" class="link">Source</a> <a href="#v:opRef1" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:opRef2" class="def">opRef2</a> :: <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> c =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:OpB">OpB</a> s '[a, b] c -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs c) <a href="src/Numeric.Backprop.html#opRef2" class="link">Source</a> <a href="#v:opRef2" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:opRef3" class="def">opRef3</a> :: <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> d =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs c -&gt; <a href="Numeric-Backprop.html#t:OpB">OpB</a> s '[a, b, c] d -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs d) <a href="src/Numeric.Backprop.html#opRef3" class="link">Source</a> <a href="#v:opRef3" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:-45--36-" class="def">(-$)</a> :: (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> as, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> as, <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a) =&gt; <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s as a -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) as -&gt; <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s rs a <span class="fixity">infixr 1</span><span class="rightedge"></span> <a href="src/Numeric.Backprop.html#-%24" class="link">Source</a> <a href="#v:-45--36-" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:-45--38-" class="def">(-&amp;)</a> :: (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> as, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> as, <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a) =&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) as -&gt; (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s as) as -&gt; <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s as a) -&gt; <a href="Numeric-Backprop.html#t:BPOp">BPOp</a> s rs a <span class="fixity">infixr 1</span><span class="rightedge"></span> <a href="src/Numeric.Backprop.html#-%26" class="link">Source</a> <a href="#v:-45--38-" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:opRef-39-" class="def">opRef'</a> :: <span class="keyword">forall</span> s rs as a. <a href="Numeric-Backprop.html#t:Summer">Summer</a> a -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) as -&gt; <a href="Numeric-Backprop.html#t:OpB">OpB</a> s as a -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a) <a href="src/Numeric.Backprop.html#opRef%27" class="link">Source</a> <a href="#v:opRef-39-" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:opRef1-39-" class="def">opRef1'</a> :: <a href="Numeric-Backprop.html#t:Summer">Summer</a> b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:OpB">OpB</a> s '[a] b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b) <a href="src/Numeric.Backprop.html#opRef1%27" class="link">Source</a> <a href="#v:opRef1-39-" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:opRef2-39-" class="def">opRef2'</a> :: <a href="Numeric-Backprop.html#t:Summer">Summer</a> c -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:OpB">OpB</a> s '[a, b] c -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs c) <a href="src/Numeric.Backprop.html#opRef2%27" class="link">Source</a> <a href="#v:opRef2-39-" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:opRef3-39-" class="def">opRef3'</a> :: <a href="Numeric-Backprop.html#t:Summer">Summer</a> d -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs c -&gt; <a href="Numeric-Backprop.html#t:OpB">OpB</a> s '[a, b, c] d -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs d) <a href="src/Numeric.Backprop.html#opRef3%27" class="link">Source</a> <a href="#v:opRef3-39-" class="selflink">#</a></p></div><h2 id="g:9">Ref manipulation</h2><h3 id="g:10">As parts</h3><div class="top"><p class="src"><a id="v:partsRef" class="def">partsRef</a> :: <span class="keyword">forall</span> s rs bs b. (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> bs, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> bs) =&gt; <a href="Numeric-Backprop-Iso.html#t:Iso-39-">Iso'</a> b (<a href="Numeric-Backprop.html#t:Tuple">Tuple</a> bs) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) bs) <a href="src/Numeric.Backprop.html#partsRef" class="link">Source</a> <a href="#v:partsRef" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:-35--60--126-" class="def">(#&lt;~)</a> :: (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> bs, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> bs) =&gt; <a href="Numeric-Backprop-Iso.html#t:Iso-39-">Iso'</a> b (<a href="Numeric-Backprop.html#t:Tuple">Tuple</a> bs) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) bs) <span class="fixity">infixr 1</span><span class="rightedge"></span> <a href="src/Numeric.Backprop.html#%23%3C~" class="link">Source</a> <a href="#v:-35--60--126-" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:withParts" class="def">withParts</a> :: (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> bs, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> bs) =&gt; <a href="Numeric-Backprop-Iso.html#t:Iso-39-">Iso'</a> b (<a href="Numeric-Backprop.html#t:Tuple">Tuple</a> bs) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) bs -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a) -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a <a href="src/Numeric.Backprop.html#withParts" class="link">Source</a> <a href="#v:withParts" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:splitRefs" class="def">splitRefs</a> :: <span class="keyword">forall</span> s rs as. (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> as, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> as) =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs (<a href="Numeric-Backprop.html#t:Tuple">Tuple</a> as) -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) as) <a href="src/Numeric.Backprop.html#splitRefs" class="link">Source</a> <a href="#v:splitRefs" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:gSplit" class="def">gSplit</a> :: (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> bs, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> bs, <a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Generic">Generic</a> b, <a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Code">Code</a> b ~ '[bs]) =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) bs) <a href="src/Numeric.Backprop.html#gSplit" class="link">Source</a> <a href="#v:gSplit" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:partsRef-39-" class="def">partsRef'</a> :: <span class="keyword">forall</span> s rs bs b. <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> bs -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> bs -&gt; <a href="Numeric-Backprop-Iso.html#t:Iso-39-">Iso'</a> b (<a href="Numeric-Backprop.html#t:Tuple">Tuple</a> bs) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) bs) <a href="src/Numeric.Backprop.html#partsRef%27" class="link">Source</a> <a href="#v:partsRef-39-" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:withParts-39-" class="def">withParts'</a> :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> bs -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> bs -&gt; <a href="Numeric-Backprop-Iso.html#t:Iso-39-">Iso'</a> b (<a href="Numeric-Backprop.html#t:Tuple">Tuple</a> bs) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) bs -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a) -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs a <a href="src/Numeric.Backprop.html#withParts%27" class="link">Source</a> <a href="#v:withParts-39-" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:splitRefs-39-" class="def">splitRefs'</a> :: <span class="keyword">forall</span> s rs as. <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> as -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> as -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs (<a href="Numeric-Backprop.html#t:Tuple">Tuple</a> as) -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) as) <a href="src/Numeric.Backprop.html#splitRefs%27" class="link">Source</a> <a href="#v:splitRefs-39-" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:gSplit-39-" class="def">gSplit'</a> :: (<a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Generic">Generic</a> b, <a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Code">Code</a> b ~ '[bs]) =&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> bs -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> bs -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) bs) <a href="src/Numeric.Backprop.html#gSplit%27" class="link">Source</a> <a href="#v:gSplit-39-" class="selflink">#</a></p></div><h3 id="g:11">As sums</h3><div class="top"><p class="src"><a id="v:choicesRef" class="def">choicesRef</a> :: <span class="keyword">forall</span> s rs bs b. (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> bs, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> bs) =&gt; <a href="Numeric-Backprop-Iso.html#t:Iso-39-">Iso'</a> b (<a href="../type-combinators-0.2.4.3/Data-Type-Sum.html#t:Sum">Sum</a> <a href="../type-combinators-0.2.4.3/Data-Type-Combinator.html#t:I">I</a> bs) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="../type-combinators-0.2.4.3/Data-Type-Sum.html#t:Sum">Sum</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) bs) <a href="src/Numeric.Backprop.html#choicesRef" class="link">Source</a> <a href="#v:choicesRef" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:choicesRef-39-" class="def">choicesRef'</a> :: <span class="keyword">forall</span> s rs bs b. <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> bs -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> bs -&gt; <a href="Numeric-Backprop-Iso.html#t:Iso-39-">Iso'</a> b (<a href="../type-combinators-0.2.4.3/Data-Type-Sum.html#t:Sum">Sum</a> <a href="../type-combinators-0.2.4.3/Data-Type-Combinator.html#t:I">I</a> bs) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="../type-combinators-0.2.4.3/Data-Type-Sum.html#t:Sum">Sum</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) bs) <a href="src/Numeric.Backprop.html#choicesRef%27" class="link">Source</a> <a href="#v:choicesRef-39-" class="selflink">#</a></p></div><h3 id="g:12">As sums of products</h3><div class="top"><p class="src"><a id="v:sopRef" class="def">sopRef</a> :: <span class="keyword">forall</span> s rs bss b. (<a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> bss, <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> <a href="../type-combinators-0.2.4.3/Type-Class-Witness.html#t:-8743-">&#8743;</a> <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a>) bss) =&gt; <a href="Numeric-Backprop-Iso.html#t:Iso-39-">Iso'</a> b (<a href="../type-combinators-0.2.4.3/Data-Type-Sum.html#t:Sum">Sum</a> <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> bss) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="../type-combinators-0.2.4.3/Data-Type-Sum.html#t:Sum">Sum</a> (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs)) bss) <a href="src/Numeric.Backprop.html#sopRef" class="link">Source</a> <a href="#v:sopRef" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:gSplits" class="def">gSplits</a> :: <span class="keyword">forall</span> s rs b. (<a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Generic">Generic</a> b, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> (<a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Code">Code</a> b), <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> <a href="../type-combinators-0.2.4.3/Type-Class-Witness.html#t:-8743-">&#8743;</a> <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a>) (<a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Code">Code</a> b)) =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="../type-combinators-0.2.4.3/Data-Type-Sum.html#t:Sum">Sum</a> (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs)) (<a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Code">Code</a> b)) <a href="src/Numeric.Backprop.html#gSplits" class="link">Source</a> <a href="#v:gSplits" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:sopRef-39-" class="def">sopRef'</a> :: <span class="keyword">forall</span> s rs bss b. <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a>) bss -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a>) bss -&gt; <a href="Numeric-Backprop-Iso.html#t:Iso-39-">Iso'</a> b (<a href="../type-combinators-0.2.4.3/Data-Type-Sum.html#t:Sum">Sum</a> <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> bss) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="../type-combinators-0.2.4.3/Data-Type-Sum.html#t:Sum">Sum</a> (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs)) bss) <a href="src/Numeric.Backprop.html#sopRef%27" class="link">Source</a> <a href="#v:sopRef-39-" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:gSplits-39-" class="def">gSplits'</a> :: <span class="keyword">forall</span> s rs b. <a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Generic">Generic</a> b =&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a>) (<a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Code">Code</a> b) -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a>) (<a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Code">Code</a> b) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="../type-combinators-0.2.4.3/Data-Type-Sum.html#t:Sum">Sum</a> (<a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs)) (<a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Code">Code</a> b)) <a href="src/Numeric.Backprop.html#gSplits%27" class="link">Source</a> <a href="#v:gSplits-39-" class="selflink">#</a></p></div><h2 id="g:13">Transforming BP</h2><div class="top"><p class="src"><a id="v:internally" class="def">internally</a> :: <span class="keyword">forall</span> s rs bs b a. (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> bs, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> bs, <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a) =&gt; <a href="Numeric-Backprop-Iso.html#t:Iso-39-">Iso'</a> b (<a href="Numeric-Backprop.html#t:Tuple">Tuple</a> bs) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s bs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s bs a) -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a) <a href="src/Numeric.Backprop.html#internally" class="link">Source</a> <a href="#v:internally" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:generically" class="def">generically</a> :: <span class="keyword">forall</span> s rs bs b a. (<a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a, <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> bs, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> bs, <a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Generic">Generic</a> b, <a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Code">Code</a> b ~ '[bs]) =&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s bs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s bs a) -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a) <a href="src/Numeric.Backprop.html#generically" class="link">Source</a> <a href="#v:generically" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:internally-39-" class="def">internally'</a> :: <span class="keyword">forall</span> s rs bs b a. <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> bs -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> bs -&gt; <a href="Numeric-Backprop.html#t:Summer">Summer</a> a -&gt; <a href="Numeric-Backprop-Iso.html#t:Iso-39-">Iso'</a> b (<a href="Numeric-Backprop.html#t:Tuple">Tuple</a> bs) -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s bs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s bs a) -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a) <a href="src/Numeric.Backprop.html#internally%27" class="link">Source</a> <a href="#v:internally-39-" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:generically-39-" class="def">generically'</a> :: <span class="keyword">forall</span> s rs bs b a. (<a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Generic">Generic</a> b, <a href="../generics-sop-0.2.4.0/Generics-SOP-Universe.html#t:Code">Code</a> b ~ '[bs]) =&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> bs -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> bs -&gt; <a href="Numeric-Backprop.html#t:Summer">Summer</a> a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s bs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s bs a) -&gt; <a href="Numeric-Backprop.html#t:BP">BP</a> s rs (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a) <a href="src/Numeric.Backprop.html#generically%27" class="link">Source</a> <a href="#v:generically-39-" class="selflink">#</a></p></div><h2 id="g:14">Combining</h2><div class="top"><p class="src"><a id="v:liftR" class="def">liftR</a> :: <a href="Numeric-Backprop.html#t:OpB">OpB</a> s as a -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> (<a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs) as -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a <a href="src/Numeric.Backprop.html#liftR" class="link">Source</a> <a href="#v:liftR" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:liftR1" class="def">liftR1</a> :: <a href="Numeric-Backprop.html#t:OpB">OpB</a> s '[a] b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b <a href="src/Numeric.Backprop.html#liftR1" class="link">Source</a> <a href="#v:liftR1" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:liftR2" class="def">liftR2</a> :: <a href="Numeric-Backprop.html#t:OpB">OpB</a> s '[a, b] c -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs c <a href="src/Numeric.Backprop.html#liftR2" class="link">Source</a> <a href="#v:liftR2" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:liftR3" class="def">liftR3</a> :: <a href="Numeric-Backprop.html#t:OpB">OpB</a> s '[a, b, c] d -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs a -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs b -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs c -&gt; <a href="Numeric-Backprop.html#t:BVar">BVar</a> s rs d <a href="src/Numeric.Backprop.html#liftR3" class="link">Source</a> <a href="#v:liftR3" class="selflink">#</a></p></div><h1 id="g:15">Op</h1><div class="top"><p class="src"><a id="v:op1" class="def">op1</a> :: <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a =&gt; (<span class="keyword">forall</span> s. <a href="../ad-4.3.2.1/Numeric-AD-Internal-Type.html#t:AD">AD</a> s (<a href="../ad-4.3.2.1/Numeric-AD-Rank1-Forward.html#t:Forward">Forward</a> a) -&gt; <a href="../ad-4.3.2.1/Numeric-AD-Internal-Type.html#t:AD">AD</a> s (<a href="../ad-4.3.2.1/Numeric-AD-Rank1-Forward.html#t:Forward">Forward</a> a)) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a] a <a href="src/Numeric.Backprop.Op.html#op1" class="link">Source</a> <a href="#v:op1" class="selflink">#</a></p><div class="doc"><p>Automatically create an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> of a numerical function taking one
 argument.  Uses <code><a href="../ad-4.3.2.1/Numeric-AD-Mode-Forward.html#v:diff">diff</a></code>, and so can take any numerical
 function polymorphic over the standard numeric types.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>gradOp' (op1 (recip . negate)) (5 ::&lt; &#216;)
</code></strong>(-0.2, 0.04 ::&lt; &#216;)
</pre></div></div><div class="top"><p class="src"><a id="v:op2" class="def">op2</a> :: <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a =&gt; (<span class="keyword">forall</span> s. <a href="../reflection-2.1.2/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="../ad-4.3.2.1/Numeric-AD-Internal-Reverse.html#t:Tape">Tape</a> =&gt; <a href="../ad-4.3.2.1/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a -&gt; <a href="../ad-4.3.2.1/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a -&gt; <a href="../ad-4.3.2.1/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a, a] a <a href="src/Numeric.Backprop.Op.html#op2" class="link">Source</a> <a href="#v:op2" class="selflink">#</a></p><div class="doc"><p>Automatically create an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> of a numerical function taking two
 arguments.  Uses <code><a href="../ad-4.3.2.1/Numeric-AD-Mode-Reverse.html#v:grad">grad</a></code>, and so can take any numerical function
 polymorphic over the standard numeric types.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>gradOp' (op2 (\x y -&gt; x * sqrt y)) (3 ::&lt; 4 ::&lt; &#216;)
</code></strong>(6.0, 2.0 ::&lt; 0.75 ::&lt; &#216;)
</pre></div></div><div class="top"><p class="src"><a id="v:op3" class="def">op3</a> :: <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a =&gt; (<span class="keyword">forall</span> s. <a href="../reflection-2.1.2/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="../ad-4.3.2.1/Numeric-AD-Internal-Reverse.html#t:Tape">Tape</a> =&gt; <a href="../ad-4.3.2.1/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a -&gt; <a href="../ad-4.3.2.1/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a -&gt; <a href="../ad-4.3.2.1/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a -&gt; <a href="../ad-4.3.2.1/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a, a, a] a <a href="src/Numeric.Backprop.Op.html#op3" class="link">Source</a> <a href="#v:op3" class="selflink">#</a></p><div class="doc"><p>Automatically create an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> of a numerical function taking three
 arguments.  Uses <code><a href="../ad-4.3.2.1/Numeric-AD-Mode-Reverse.html#v:grad">grad</a></code>, and so can take any numerical function
 polymorphic over the standard numeric types.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>gradOp' (op3 (\x y z -&gt; (x * sqrt y)**z)) (3 ::&lt; 4 ::&lt; 2 ::&lt; &#216;)
</code></strong>(36.0, 24.0 ::&lt; 9.0 ::&lt; 64.503 ::&lt; &#216;)
</pre></div></div><div class="top"><p class="src"><a id="v:opN" class="def">opN</a> :: (<a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> a, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Nat.html#t:Nat">Nat</a> n) =&gt; (<span class="keyword">forall</span> s. <a href="../reflection-2.1.2/Data-Reflection.html#t:Reifies">Reifies</a> s <a href="../ad-4.3.2.1/Numeric-AD-Internal-Reverse.html#t:Tape">Tape</a> =&gt; <a href="Numeric-Backprop-Op-Mono.html#t:Vec">Vec</a> n (<a href="../ad-4.3.2.1/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a) -&gt; <a href="../ad-4.3.2.1/Numeric-AD-Mode-Reverse.html#t:Reverse">Reverse</a> s a) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> (<a href="Numeric-Backprop-Op.html#t:Replicate">Replicate</a> n a) a <a href="src/Numeric.Backprop.Op.html#opN" class="link">Source</a> <a href="#v:opN" class="selflink">#</a></p><div class="doc"><p>Automatically create an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> of a numerical function taking multiple
 arguments.  Uses <code><a href="../ad-4.3.2.1/Numeric-AD-Mode-Reverse.html#v:grad">grad</a></code>, and so can take any numerical
 function polymorphic over the standard numeric types.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>gradOp' (opN (\(x :+ y :+ &#216;) -&gt; x * sqrt y)) (3 ::&lt; 4 ::&lt; &#216;)
</code></strong>(6.0, 2.0 ::&lt; 0.75 ::&lt; &#216;)
</pre></div></div><div class="top"><p class="src"><a id="v:op1-39-" class="def">op1'</a> :: (a -&gt; (b, <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> b -&gt; a)) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a] b <a href="src/Numeric.Backprop.Op.html#op1%27" class="link">Source</a> <a href="#v:op1-39-" class="selflink">#</a></p><div class="doc"><p>Create an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> of a function taking one input, by giving its explicit
 derivative.  The function should return a tuple containing the result of
 the function, and also a function taking the derivative of the result
 and return the derivative of the input.</p><p>If we have</p><p>\[
 \eqalign{
 f &amp;: \mathbb{R} \rightarrow \mathbb{R}\cr
 y &amp;= f(x)\cr
 z &amp;= g(y)
 }
 \]</p><p>Then the derivative \( \frac{dz}{dx} \), it would be:</p><p>\[
 \frac{dz}{dx} = \frac{dz}{dy} \frac{dy}{dx}
 \]</p><p>If our <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> represents \(f\), then the second item in the resulting
 tuple should be a function that takes \(\frac{dz}{dy}\) and returns
 \(\frac{dz}{dx}\).</p><p>If the input is <code><a href="../base-4.9.1.0/Data-Maybe.html#v:Nothing">Nothing</a></code>, then \(\frac{dz}{dy}\) should be taken to be
 \(1\).</p><p>As an example, here is an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> that squares its input:</p><pre>square :: Num a =&gt; <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> '[a] a
square = <code><a href="Numeric-Backprop.html#v:op1-39-">op1'</a></code> $ x -&gt; (x*x, case Nothing -&gt; 2 * x
                                  Just d  -&gt; 2 * d * x
                      )
</pre><p>Remember that, generally, end users shouldn't directly construct <code><a href="Numeric-Backprop.html#t:Op">Op</a></code>s;
 they should be provided by libraries or generated automatically.</p><p>For numeric functions, single-input <code><a href="Numeric-Backprop.html#t:Op">Op</a></code>s can be generated automatically
 using <code><a href="Numeric-Backprop.html#v:op1">op1</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:op2-39-" class="def">op2'</a> :: (a -&gt; b -&gt; (c, <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> c -&gt; (a, b))) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a, b] c <a href="src/Numeric.Backprop.Op.html#op2%27" class="link">Source</a> <a href="#v:op2-39-" class="selflink">#</a></p><div class="doc"><p>Create an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> of a function taking two inputs, by giving its explicit
 gradient.  The function should return a tuple containing the result of
 the function, and also a function taking the derivative of the result
 and return the derivative of the input.</p><p>If we have</p><p>\[
 \eqalign{
 f &amp;: \mathbb{R}^2 \rightarrow \mathbb{R}\cr
 z &amp;= f(x, y)\cr
 k &amp;= g(z)
 }
 \]</p><p>Then the gradient \( \left&lt; \frac{\partial k}{\partial x}, \frac{\partial k}{\partial y} \right&gt; \)
 would be:</p><p>\[
 \left&lt; \frac{\partial k}{\partial x}, \frac{\partial k}{\partial y} \right&gt; =
  \left&lt; \frac{dk}{dz} \frac{\partial z}{dx}, \frac{dk}{dz} \frac{\partial z}{dy} \right&gt;
 \]</p><p>If our <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> represents \(f\), then the second item in the resulting
 tuple should be a function that takes \(\frac{dk}{dz}\) and returns
 \( \left&lt; \frac{\partial k}{dx}, \frac{\partial k}{dx} \right&gt; \).</p><p>If the input is <code><a href="../base-4.9.1.0/Data-Maybe.html#v:Nothing">Nothing</a></code>, then \(\frac{dk}{dz}\) should be taken to be
 \(1\).</p><p>As an example, here is an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> that multiplies its inputs:</p><pre>mul :: Num a =&gt; <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> '[a, a] a
mul = <code><a href="Numeric-Backprop.html#v:op2-39-">op2'</a></code> $ x y -&gt; (x*y, case Nothing -&gt; (y  , x  )
                                 Just d  -&gt; (d*y, x*d)
                     )
</pre><p>Remember that, generally, end users shouldn't directly construct <code><a href="Numeric-Backprop.html#t:Op">Op</a></code>s;
 they should be provided by libraries or generated automatically.</p><p>For numeric functions, two-input <code><a href="Numeric-Backprop.html#t:Op">Op</a></code>s can be generated automatically
 using <code><a href="Numeric-Backprop.html#v:op2">op2</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:op3-39-" class="def">op3'</a> :: (a -&gt; b -&gt; c -&gt; (d, <a href="../base-4.9.1.0/Data-Maybe.html#t:Maybe">Maybe</a> d -&gt; (a, b, c))) -&gt; <a href="Numeric-Backprop.html#t:Op">Op</a> '[a, b, c] d <a href="src/Numeric.Backprop.Op.html#op3%27" class="link">Source</a> <a href="#v:op3-39-" class="selflink">#</a></p><div class="doc"><p>Create an <code><a href="Numeric-Backprop.html#t:Op">Op</a></code> of a function taking three inputs, by giving its explicit
 gradient.  See documentation for <code><a href="Numeric-Backprop.html#v:op2-39-">op2'</a></code> for more details.</p></div></div><h1 id="g:16">Utility</h1><div class="top"><p class="src"><span class="keyword">pattern</span> <a id="v::-62-" class="def">(:&gt;)</a> :: <span class="keyword">forall</span> k f a b. f a -&gt; f b -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f ((:) k a ((:) k b ([] k))) <span class="fixity">infix 6</span><span class="rightedge"></span> <a href="#v::-62-" class="selflink">#</a></p><div class="doc"><p>Construct a two element Prod.
   Since the precedence of (:&gt;) is higher than (:&lt;),
   we can conveniently write lists like:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>a :&lt; b :&gt; c
</code></strong></pre><p>Which is identical to:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>a :&lt; b :&lt; c :&lt; &#216;
</code></strong></pre></div></div><div class="top"><p class="src"><a id="v:only" class="def">only</a> :: f a -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f ((:) k a ([] k)) <a href="#v:only" class="selflink">#</a></p><div class="doc"><p>Build a singleton Prod.</p></div></div><div class="top"><p class="src"><a id="v:head-39-" class="def">head'</a> :: <a href="Numeric-Backprop.html#t:Prod">Prod</a> k f (<a href="../type-combinators-0.2.4.3/Type-Family-List.html#t::-60-">(:&lt;)</a> k a as) -&gt; f a <a href="#v:head-39-" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">pattern</span> <a id="v:::-60-" class="def">(::&lt;)</a> :: <span class="keyword">forall</span> a as. a -&gt; <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> as -&gt; <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> (<a href="../type-combinators-0.2.4.3/Type-Family-List.html#t::-60-">(:&lt;)</a> <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> a as) <span class="fixity">infixr 5</span><span class="rightedge"></span> <a href="#v:::-60-" class="selflink">#</a></p><div class="doc"><p>Cons onto a Tuple.</p></div></div><div class="top"><p class="src"><a id="v:only_" class="def">only_</a> :: a -&gt; <a href="Numeric-Backprop.html#t:Tuple">Tuple</a> ((:) <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a> a ([] <a href="../base-4.9.1.0/Data-Kind.html#t:-42-">*</a>)) <a href="#v:only_" class="selflink">#</a></p><div class="doc"><p>Singleton Tuple.</p></div></div><div class="top"><p class="src"><a id="v:summers" class="def">summers</a> :: (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> as, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> as) =&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> as <a href="src/Numeric.Backprop.Internal.Helper.html#summers" class="link">Source</a> <a href="#v:summers" class="selflink">#</a></p><div class="doc"><p>If all the types in <code>as</code> are instances of <code><a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a></code>, generate a <code><code><a href="Numeric-Backprop.html#t:Prod">Prod</a></code>
 <code><a href="Numeric-Backprop.html#t:Summer">Summer</a></code> as</code>, or a tuple of <code><a href="Numeric-Backprop.html#t:Summer">Summer</a></code>s for every type in <code>as</code>.</p></div></div><div class="top"><p class="src"><a id="v:unities" class="def">unities</a> :: (<a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> as, <a href="../type-combinators-0.2.4.3/Type-Class-Known.html#t:Known">Known</a> <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> as) =&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> as <a href="src/Numeric.Backprop.Internal.Helper.html#unities" class="link">Source</a> <a href="#v:unities" class="selflink">#</a></p><div class="doc"><p>If all the types in <code>as</code> are instances of <code><a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a></code>, generate a <code><code><a href="Numeric-Backprop.html#t:Prod">Prod</a></code>
 <code><a href="Numeric-Backprop.html#t:Unity">Unity</a></code> as</code>, or a tuple of <code><a href="Numeric-Backprop.html#t:Unity">Unity</a></code>s for every type in <code>as</code>.</p></div></div><div class="top"><p class="src"><a id="v:summers-39-" class="def">summers'</a> :: <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> as =&gt; <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> as -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Summer">Summer</a> as <a href="src/Numeric.Backprop.Internal.Helper.html#summers%27" class="link">Source</a> <a href="#v:summers-39-" class="selflink">#</a></p><div class="doc"><p>Like <code><a href="Numeric-Backprop.html#v:summers">summers</a></code>, but requiring an explicit witness for the number of
 types in the list <code>as</code>.</p></div></div><div class="top"><p class="src"><a id="v:unities-39-" class="def">unities'</a> :: <a href="../type-combinators-0.2.4.3/Data-Type-Index.html#t:Every">Every</a> <a href="../base-4.9.1.0/Prelude.html#t:Num">Num</a> as =&gt; <a href="../type-combinators-0.2.4.3/Data-Type-Length.html#t:Length">Length</a> as -&gt; <a href="Numeric-Backprop.html#t:Prod">Prod</a> <a href="Numeric-Backprop.html#t:Unity">Unity</a> as <a href="src/Numeric.Backprop.Internal.Helper.html#unities%27" class="link">Source</a> <a href="#v:unities-39-" class="selflink">#</a></p><div class="doc"><p>Like <code><a href="Numeric-Backprop.html#v:unities">unities</a></code>, but requiring an explicit witness for the number of
 types in the list <code>as</code>.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.17.3</p></div></body></html>